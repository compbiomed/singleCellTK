<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Find Marker • singleCellTK</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="Find Marker">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">singleCellTK</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.18.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="https://www.camplab.net/sctk" class="external-link">
    <span class="fas fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01_import_and_qc_tutorial.html">Importing and QC - PBMC3K</a>
    </li>
    <li>
      <a href="../articles/02_a_la_carte_workflow.html">A La Carte Workflow - PBMC3K</a>
    </li>
    <li>
      <a href="../articles/seurat_curated_workflow.html">Seurat Curated Workflow - PBMC3K</a>
    </li>
    <li>
      <a href="../articles/celda_curated_workflow.html">Celda Curated Workflow - PBMC3K</a>
    </li>
    <li>
      <a href="../articles/scanpy_curated_workflow.html">Scanpy Curated Workflow - PBMC3K</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/cmd_qc.html">SCTK-QC</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Documentation

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Data</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/import_data.html">Import Data</a>
        </li>
        <li>
          <a href="../articles/import_genesets.html">Import Gene Sets</a>
        </li>
        <li>
          <a href="../articles/import_annotation.html">Annotation</a>
        </li>
        <li>
          <a href="../articles/export_data.html">Export Data</a>
        </li>
        <li>
          <a href="../articles/delete_data.html">Delete Data</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">QC &amp; Filtering</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/cnsl_dropletqc.html">Droplet QC (R console)</a>
        </li>
        <li>
          <a href="../articles/cnsl_cellqc.html">Cell QC (R console)</a>
        </li>
        <li>
          <a href="../articles/ui_qc.html">Cell QC (Shiny UI)</a>
        </li>
        <li>
          <a href="../articles/filtering.html">Filtering</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Normalization &amp; Batch Correction</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/normalization.html">Normalization</a>
        </li>
        <li>
          <a href="../articles/batch_correction.html">Batch Correction</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Feature Selection &amp; Dimensionality Reduction</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/feature_selection.html">Feature Selection</a>
        </li>
        <li>
          <a href="../articles/dimensionality_reduction.html">Dimensionality Reduction</a>
        </li>
        <li>
          <a href="../articles/2d_embedding.html">2D Embedding</a>
        </li>
      </ul>
</li>
    <li>
      <a href="../articles/clustering.html">Clustering</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Differential Expression &amp; Cell Type Labeling</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/differential_expression.html">Differential Expression</a>
        </li>
        <li>
          <a href="../articles/find_marker.html">Find Marker</a>
        </li>
        <li>
          <a href="../articles/cell_type_labeling.html">Cell Type Labeling</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Pathway &amp; Enrichment Analysis</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/enrichR.html">EnrichR</a>
        </li>
        <li>
          <a href="../articles/pathwayAnalysis.html">Pathway Analysis</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Trajectory Analysis</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/trajectoryAnalysis.html">TSCAN</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Curated Workflows</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/seurat_curated_workflow.html">Seurat</a>
        </li>
        <li>
          <a href="../articles/celda_curated_workflow.html">Celda</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Visualization</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/visualization.html">General Visualization</a>
        </li>
        <li>
          <a href="../articles/heatmap.html">Generic Heatmap</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Web Application</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/webApp.html">FAQs</a>
        </li>
      </ul>
</li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">NEWS</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/compbiomed/singleCellTK" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
<li>
  <a href="https://twitter.com/camplab1" class="external-link">
    <span class="fab fa-twitter fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Find Marker</h1>
                        <h4 data-toc-skip class="author">Yichen
Wang</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/compbiomed/singleCellTK/blob/HEAD/vignettes/articles/find_marker.Rmd" class="external-link"><code>vignettes/articles/find_marker.Rmd</code></a></small>
      <div class="hidden name"><code>find_marker.Rmd</code></div>

    </div>

    
    

<meta name="viewport" content="width=device-width, initial-scale=1">
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This section comes together with the previous section <a href="differential_expression.html">Differential Expression</a>. The
basic strategy singleCellTK (SCTK) uses to find biomarkers is to
iteratively identify the significantly up-regulated features of each
group of cells against all the other cells. This means, the function we
have (<code><a href="../reference/runFindMarker.html">runFindMarker()</a></code>) is a wrapper of functions that do
differential expression (DE) analysis, which would be invoked in a loop.
For the detail of the DE functions and DE computation methods, please
refer to the <a href="differential_expression.html">Differential
Expression documentation</a>.</p>
<p>To view detailed instructions on how to use these methods, please
select ‘Interactive Analysis’ for shiny application or ‘Console
Analysis’ for using these methods on R console from the tabs below:
<br></p>
</div>
<div class="section level2">
<h2 id="workflow-guide">Workflow Guide<a class="anchor" aria-label="anchor" href="#workflow-guide"></a>
</h2>
<div class="tab">
  <button class="tablinks" onclick="openTab(event, 'interactive')" id="ia-button">Interactive Analysis</button>
  <button class="tablinks" onclick="openTab(event, 'console')" id="console-button">Console Analysis</button>
</div>

<div id="interactive" class="tabcontent">
<p><strong>Entry of The Panel</strong></p>
<p>From anywhere of the UI, the panel for marker finding can be accessed
from the top navigation panel at the circled tab shown below.</p>
<p><img src="ui_screenshots/find_marker/fm_ui_entry.png" alt="Entry"><br></p>
<p>The UI is constructed in a sidebar pattern. The sidebar on the left
is mainly for the parameters essential for running the marker finding
algorithm. The main panel on the right is for demonstrating the results,
including the marker table and the heatmap visualization.</p>
<p><img src="ui_screenshots/find_marker/fm_ui_main1.png" alt="main1"><br></p>
<details><summary><b>Detail: Algorithm Parameters</b></summary><ul>
<li>Method selection - selection input <strong>“Select Differential
Expression Method”</strong>. Users will choose which method to use. The
method here means the intrinsic dependency used for differential
expression (DE) analysis.</li>
<li>Assay selection - selection input <strong>“Select Assay”</strong>.
Users will choose which expression data matrix to use for marker
detection. Note that for method “MAST” and “Limma”, a log-normalized
feature expression matrix is required.</li>
<li>Cluster definition - selection input <strong>“Cluster
Annotation”</strong>. Users will choose a cell level annotation, which
defines the cluster assignment for each cell.</li>
<li>Covariate selection - selection input
<strong>“Covariate(s)”</strong>. A covariate is another set of
categorization on the cells involved in the analysis, used for modeling.
Multiple selections are acceptable.</li>
<li>Log2FC cutoff setting - numeric input <strong>“Log2FC greater
than”</strong>. The cutoff set here will rule out DE genes with absolute
value of Log2FC (logged fold change) smaller than the cutoff from the
result.</li>
<li>FDR cutoff setting - numeric input <strong>“FDR less than”</strong>.
The cutoff set here will rule out DE genes with FDR (false discovery
rate) value more than the cutoff from the result.</li>
<li>Expression percentage cutoff - numeric inputs <strong>“Minimum
Expressed Percentage in Cluster”</strong> and <strong>“Maximum Expressed
Percentage in Control”</strong>. These are filters that will be applied
on the result table. Known that the markers for one cluster is
identified by performing DE analysis on this cluster against all other
cells, the first parameter rules out the marker genes that are expressed
in less than a percentage of cells in the cluster of interests. In a
similar way, the second parameter excludes the marker genes expressed in
more that a percentage of cells in all other clusters.<br>
</li>
<li>Mean expression level cutoff - numeric input <strong>“Minimum Mean
Expression Level in Cluster”</strong>. Following the last bullet point,
this parameter will keep only the marker genes with mean expression
level in the cluster higher than higher than a value.</li>
</ul></details><br><p><strong>Main Panel - Result Table</strong></p>
<p>The table is shown in the figure above. In this tab, there will be a
table for all the markers detected and passed the filters. It is
constructed with 5 columns, including <strong>“Gene”</strong> - the
default feature identifiers (not necessarily a gene ID or symbol,
depending on the background SCE object); <strong>“Log2_FC”</strong>,
<strong>“Pvalue”</strong> and <strong>“FDR”</strong> - the statistics
that supports the detection; and the fifth one that labels which cluster
the marker is for, and the column name is exactly the <strong>“cluster
annotation”</strong> selected in the sidebar. Users can also download
the table in comma-separated value (CSV) format, by clicking
<strong>“Download Result Table”</strong> button.</p>
<p><strong>Main Panel - Heatmap</strong></p>
<p><img src="ui_screenshots/find_marker/fm_ui_main2.png" alt="main2"><br></p>
<p>A heatmap will be automatically generated after running the marker
detection process. Users can tweak the options for plotting by clicking
on the blue clog button on the top-left.</p>
<details><summary><b>Detail: Heatmap Plotting Options</b></summary><ul>
<li>Cluster ordering - radio button <strong>“Order blocks by”</strong>.
User will determine here whether to order the columns of the heatmap by
the cluster name (i.e. annotation) or the size (i.e. number of cells).
Checkbox <strong>“Decreasing”</strong>. Users can check this option for
putting the alphabetically latter cluster or cluster with the largest
size on the left.</li>
<li>Top N marker cutoff - checkbox and numeric input <strong>“Plot Top N
markers of each cluster”</strong>. If the checkbox is not checked, all
markers passing the running filter (mentioned above) and plotting
filters (will mention below) will be plotted. Otherwise checked, only
the top <code>N</code> markers, as <code>N</code> is the input numeric
value in the numeric input below the checkbox, for each cluster will be
plotted. The ranking is based on Log2FC value. When less than
<code>N</code> markers are detected for one cluster, all of them will be
plotted.</li>
<li>Log2FC cutoff - numeric input <strong>“Plot Log2FC greater
than”</strong>. The cutoff set here will rule out markers with absolute
value of Log2FC (logged fold change) smaller than the cutoff from the
plotting. This will not affect the result saved when running the
algorithm.</li>
<li>FDR cutoff - numeric input <strong>““</strong>. The cutoff set here
will rule out markers with FDR (false discovery rate) value more than
the cutoff from the plotting. Similarly, this will not affect the result
saved when running the algorithm.</li>
<li>Expression percentage cutoff - numeric inputs <strong>“Plot Cluster
Expression Percentage More Than”</strong> and <strong>“Plot Control
Expression Percentage Less Than”</strong>. These are filters that will
be applied on the result table. Known that the markers for one cluster
is identified by performing DE analysis on this cluster against all
other cells, the first parameter rules out the marker genes that are
expressed in less than a percentage of cells in the cluster of
interests. In a similar way, the second parameter excludes the marker
genes expressed in more that a percentage of cells in all other
clusters.<br>
</li>
<li>Mean expression level cutoff - numeric input <strong>“Plot Mean
Cluster Expression Level More Than”</strong>. Following the last bullet
point, this parameter will keep only the marker genes with mean
expression level in the cluster higher than higher than a value.</li>
<li>Additional annotation - multiple selection input <strong>“Additional
feature annotation”</strong> and <strong>“Additional cell
annotation”</strong>. User can add up more cell or gene annotation to
the heatmap legend.</li>
</ul></details><br>
</div>

<div id="console" class="tabcontent">
<p><strong>Parameters</strong></p>
<p>As per SCTK’s strategy, the primary input is limited to an <a href="https://rdrr.io/bioc/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a>
(SCE) object, which has been through preprocessing steps with cluster
labels annotated. While the iteration is a fixed pattern, the parameters
needed are rather simple:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runFindMarker.html">runFindMarker</a></span><span class="op">(</span>inSCE <span class="op">=</span> <span class="va">sce</span>, useAssay <span class="op">=</span> <span class="st">"logcounts"</span>, cluster <span class="op">=</span> <span class="st">"cluster"</span>, covariates <span class="op">=</span> <span class="cn">NULL</span>, log2fcThreshold <span class="op">=</span> <span class="fl">0.25</span>, fdrThreshold <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p>Here all arguments execpt the input SCE object (<code>inSCE</code>)
are set by default. <code>method</code> can only be chosen from the
table above. <code>cluster</code> and <code>covariates</code> should be
given a single string which is present in
<code>names(colData(inSCE))</code>. <code>cluster</code> is required for
grouping cells, while <code>covariates</code> is optional for DE
detection. <code>log2fcThreshold</code> and <code>fdrThreshold</code>
are numeric and has to be set in plausible range.
<code>log2fcThrshold</code> has to be positive and
<code>fdrThreshold</code> has to be greater than zero and less than
one.</p>
<p>The returned SCE object will contain the updated information of the
markers identified in its <code>metadata</code> slot.</p>
<details><summary><b>Example</b></summary><p><strong>Preprocessing</strong></p>
<p>The preprocessing for obtaining cluster assignment was done using the
exactly same workflow presented in the <a href="02_a_la_carte_workflow.html">A La Carte Workflow Tutorial</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.camplab.net/sctk/" class="external-link">singleCellTK</a></span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/importExampleData.html">importExampleData</a></span><span class="op">(</span><span class="st">"pbmc3k"</span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPerCellQC.html">runPerCellQC</a></span><span class="op">(</span><span class="va">sce</span>, mitoRef <span class="op">=</span> <span class="st">"human"</span>, mitoIDType <span class="op">=</span> <span class="st">"symbol"</span>, mitoGeneLocation <span class="op">=</span> <span class="st">"rownames"</span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subsetSCECols.html">subsetSCECols</a></span><span class="op">(</span><span class="va">sce</span>, colData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'total &gt; 600'</span>, <span class="st">'detected &gt; 300'</span>, <span class="st">'mito_percent &lt; 5'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scaterlogNormCounts.html">scaterlogNormCounts</a></span><span class="op">(</span><span class="va">sce</span>, useAssay <span class="op">=</span> <span class="st">"counts"</span>, assayName <span class="op">=</span> <span class="st">"logcounts"</span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runModelGeneVar.html">runModelGeneVar</a></span><span class="op">(</span><span class="va">sce</span>, useAssay <span class="op">=</span> <span class="st">"logcounts"</span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getTopHVG.html">setTopHVG</a></span><span class="op">(</span><span class="va">sce</span>, method <span class="op">=</span> <span class="st">"modelGeneVar"</span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scaterPCA.html">scaterPCA</a></span><span class="op">(</span>inSCE <span class="op">=</span> <span class="va">sce</span>, useAssay <span class="op">=</span> <span class="st">"logcounts"</span>, useFeatureSubset <span class="op">=</span> <span class="st">"HVG_modelGeneVar2000"</span>, </span>
<span>                 reducedDimName <span class="op">=</span> <span class="st">"PCA"</span>, seed <span class="op">=</span> <span class="fl">12345</span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runScranSNN.html">runScranSNN</a></span><span class="op">(</span><span class="va">sce</span>, useReducedDim <span class="op">=</span> <span class="st">"PCA"</span>, nComp <span class="op">=</span> <span class="fl">10</span>, k <span class="op">=</span> <span class="fl">14</span>,</span>
<span>                   weightType <span class="op">=</span> <span class="st">"jaccard"</span>, clusterName <span class="op">=</span> <span class="st">"cluster"</span>, seed <span class="op">=</span> <span class="fl">12345</span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runUMAP.html">runUMAP</a></span><span class="op">(</span><span class="va">sce</span>, useReducedDim <span class="op">=</span> <span class="st">"PCA"</span>, initialDims <span class="op">=</span> <span class="fl">10</span>, reducedDimName <span class="op">=</span> <span class="st">"UMAP"</span>, seed <span class="op">=</span> <span class="fl">12345</span><span class="op">)</span></span></code></pre></div>
<p>And we can visualize the cell populations on the UMAP with cluster
labeled.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotSCEDimReduceColData.html">plotSCEDimReduceColData</a></span><span class="op">(</span><span class="va">sce</span>, colorBy <span class="op">=</span> <span class="st">"cluster"</span>, reducedDimName <span class="op">=</span> <span class="st">"UMAP"</span><span class="op">)</span></span></code></pre></div>
<p><img src="find_marker_files/figure-html/de_prep_plot-1.png" width="700"></p>
<p><strong>Get Markers</strong></p>
<p>Then we call <code><a href="../reference/runFindMarker.html">runFindMarker()</a></code> on the clustered data, with
the cluster annotation just obtained, <code>"cluster"</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runFindMarker.html">runFindMarker</a></span><span class="op">(</span>inSCE <span class="op">=</span> <span class="va">sce</span>, useAssay <span class="op">=</span> <span class="st">"logcounts"</span>, cluster <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span></span></code></pre></div>
</details><br><p><strong>Results</strong></p>
<p>After successfully running <code><a href="../reference/runFindMarker.html">runFindMarker()</a></code>, the result
marker table would be stored in <code>metadata(sce)</code>. This table
can be fetched by <code><a href="../reference/getFindMarkerTopTable.html">getFindMarkerTopTable()</a></code>. Argument
<code>topN</code> controls how many top markers, that pass filters, to
include for each clsuter.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getFindMarkerTopTable.html">getFindMarkerTopTable</a></span><span class="op">(</span><span class="va">sce</span>, log2fcThreshold <span class="op">=</span> <span class="fl">0</span>, minClustExprPerc <span class="op">=</span> <span class="fl">0.5</span>, topN <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           Gene   Log2_FC        Pvalue           FDR cluster clusterExprPerc</span></span>
<span><span class="co">## 1956    S100A9 4.3918388 1.231801e-205 2.016334e-201       1       0.9976852</span></span>
<span><span class="co">## 26958     CCR7 0.6107894  7.062217e-41  3.400042e-38       2       0.5662338</span></span>
<span><span class="co">## 87641     IL7R 0.6949784  1.462605e-36  1.294129e-33       3       0.7493404</span></span>
<span><span class="co">## 26825     CCL5 3.0724416 1.407334e-149 4.607331e-145       4       0.9715909</span></span>
<span><span class="co">## 106781 HLA-DRA 3.2851089 6.201038e-183 1.015048e-178       5       1.0000000</span></span>
<span><span class="co">## 16364      CD2 0.5344754  6.223183e-26  2.263717e-22       6       0.6377246</span></span>
<span><span class="co">## 106091    LST1 2.8798261 3.464220e-101  3.780388e-97       7       1.0000000</span></span>
<span><span class="co">## 310761    NKG7 4.2518808  8.025412e-81  2.627359e-76       8       1.0000000</span></span>
<span><span class="co">## 288182    CST3 3.2975861  2.221917e-16  1.039159e-12       9       1.0000000</span></span>
<span><span class="co">## 7697      PPBP 5.9620589  9.423341e-07  2.504757e-03      10       1.0000000</span></span>
<span><span class="co">##        ControlExprPerc clusterAveExpr</span></span>
<span><span class="co">## 1956        0.23234624      4.7456645</span></span>
<span><span class="co">## 26958       0.13425513      0.7668583</span></span>
<span><span class="co">## 87641       0.34697509      1.2221913</span></span>
<span><span class="co">## 26825       0.21538462      3.4483627</span></span>
<span><span class="co">## 106781      0.49561018      4.4163508</span></span>
<span><span class="co">## 16364       0.27387702      0.8940661</span></span>
<span><span class="co">## 106091      0.30363036      3.4602852</span></span>
<span><span class="co">## 310761      0.25777778      4.7980173</span></span>
<span><span class="co">## 288182      0.39113680      4.3717555</span></span>
<span><span class="co">## 7697        0.02406417      5.9894455</span></span></code></pre>
<p>Similarly to the Differential Expression section, we also provide a
automated and organized <strong>heatmap plotting</strong> for the
markers:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotFindMarkerHeatmap.html">plotFindMarkerHeatmap</a></span><span class="op">(</span><span class="va">sce</span>, log2fcThreshold <span class="op">=</span> <span class="fl">0</span>, minClustExprPerc <span class="op">=</span> <span class="fl">0.5</span>, maxCtrlExprPerc <span class="op">=</span> <span class="fl">0.5</span>, rowLabel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="find_marker_files/figure-html/plotMarkers-1.png" width="672"></p>
<p>Note that when plotting the heatmap, the genes that are identified as
up-regulated in multiple clusters will be considered only for the one
cluster with the highest fold-change, while all of them are still kept
in the table in <code>metadata</code>.</p>
</div>
<script>
document.getElementById("ia-button").click();
</script>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Yichen Wang, Irzam Sarfraz, Rui Hong, Yusuke Koga, Salam Alabdullatif, Nida Pervaiz, David Jenkins, Vidya Akavoor, Xinyun Cao, Shruthi Bandyadka, Anastasia Leshchyk, Tyler Faits, Mohammed Muzamil Khan, Zhe Wang, W. Evan Johnson, Ming Liu, Joshua David Campbell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
