<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quality Control in R console • singleCellTK</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quality Control in R console">
<meta property="og:description" content="singleCellTK">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">singleCellTK</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/introduction_to_SCTK.html">General Workflow</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Shell Command Line Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cmd_import_scRNAseq_data_as_SCE.html">Import data into SCTK</a>
    </li>
    <li>
      <a href="../articles/cmd_qc.html">Quality Control</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R Console Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cnsl_import_scRNAseq_data_as_SCE.html">Import data into SCTK</a>
    </li>
    <li>
      <a href="../articles/cnsl_qc.html">Quality Control</a>
    </li>
    <li>
      <a href="../articles/cnsl_normalization.html">Normalization</a>
    </li>
    <li>
      <a href="../articles/cnsl_batch_correction.html">Batch Correction</a>
    </li>
    <li>
      <a href="../articles/cnsl_feature_selection.html">Feature Selection</a>
    </li>
    <li>
      <a href="../articles/cnsl_clustering.html">Clustering</a>
    </li>
    <li>
      <a href="../articles/cnsl_differential_expression.html">Differential Expression</a>
    </li>
    <li>
      <a href="../articles/cnsl_find_marker.html">Find Marker via DE</a>
    </li>
    <li>
      <a href="../articles/cnsl_visualization.html">Visualization</a>
    </li>
    <li>
      <a href="../articles/cnsl_heatmap.html">Heatmap Visualization</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Shiny UI Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Import</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/ui_import_data.html">Data</a>
        </li>
        <li>
          <a href="../articles/ui_import_genesets.html">Gene Sets</a>
        </li>
        <li>
          <a href="../articles/ui_import_cell_annotation.html">Cell Annotation</a>
        </li>
        <li>
          <a href="../articles/ui_import_feature_annotation.html">Feature Annotation</a>
        </li>
        <li>
          <a href="../articles/ui_export_data.html">Export Data</a>
        </li>
        <li>
          <a href="../articles/ui_delete_data.html">Delete Data</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">QC &amp; Filtering</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/ui_qc.html">Quality Control</a>
        </li>
        <li>
          <a href="../articles/ui_filtering.html">Filtering</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Normalization &amp; Batch Correction</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/ui_normalization.html">Normalization</a>
        </li>
        <li>
          <a href="../articles/ui_batch_correction.html">Batch Correction</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Feature Selection &amp; Dimensionality Reduction</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/ui_feature_selection.html">Feature Selection</a>
        </li>
        <li>
          <a href="../articles/ui_dimred.html">Dimensionality Reduction</a>
        </li>
      </ul>
</li>
    <li>
      <a href="../articles/ui_clustering.html">Clustering</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Differential Expression &amp; Cell Type Labeling</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/ui_differential_expression.html">Differential Expression</a>
        </li>
        <li>
          <a href="../articles/ui_find_marker.html">Find Marker</a>
        </li>
      </ul>
</li>
    <li>
      <a href="../articles/ui_heatmap.html">Generic Heatmap</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/compbiomed/singleCellTK">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="cnsl_qc_files/header-attrs-2.7/header-attrs.js"></script><script src="cnsl_qc_files/kePrint-0.0.1/kePrint.js"></script><link href="cnsl_qc_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Quality Control in R console</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/compbiomed/singleCellTK/blob/master/vignettes/cnsl_qc.Rmd"><code>vignettes/cnsl_qc.Rmd</code></a></small>
      <div class="hidden name"><code>cnsl_qc.Rmd</code></div>

    </div>

    
    
<style>
body {
text-align: justify}
</style>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Performing comprehensive quality control (QC) is necessary to remove poor quality cells for downstream analysis of single-cell RNA sequencing (scRNA-seq) data. Within droplet-based scRNA-seq data, droplets containing cells must be differentiated from empty droplets. Therefore, assessment of the data is required, for which various QC algorithms have been developed. In singleCellTK, we have written convenience functions for several of these tools. In this guide, we will demonstrate how to use these functions to perform quality control on unfiltered, droplet-level data.</p>
<p>The package can be loaded using the <code>library</code> command.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://compbiomed.github.io/sctk_docs/">singleCellTK</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="running-quality-control-of-droplet-raw-count-data-with-singlecelltk" class="section level2">
<h2 class="hasAnchor">
<a href="#running-quality-control-of-droplet-raw-count-data-with-singlecelltk" class="anchor"></a>Running quality control of droplet raw count data with singleCellTK</h2>
<div id="load-pbmc4k-data-from-10x" class="section level3">
<h3 class="hasAnchor">
<a href="#load-pbmc4k-data-from-10x" class="anchor"></a>Load PBMC4k data from 10X</h3>
<p>singleCellTK takes in a <code>SingleCellExperiment</code> object from the <a href="https://bioconductor.org/packages/release/bioc/html/SingleCellExperiment.html">SingleCellExperiment</a> package. We will utilize the 10X PBMC 4K dataset as an example. For the quality control of droplet-based counts data, we will install the dataset from the 10X Genomics website using the <code>BiocFileCache</code>(<a href="https://www.bioconductor.org/packages/release/bioc/html/BiocFileCache.html" class="uri">https://www.bioconductor.org/packages/release/bioc/html/BiocFileCache.html</a>) package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Install BiocFileCache if is it not already</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocFileCache"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"BiocFileCache"</span><span class="op">)</span>
<span class="op">}</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"BiocFileCache"</span><span class="op">)</span>
<span class="va">bfc</span> <span class="op">&lt;-</span> <span class="fu">BiocFileCache</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocFileCache/man/BiocFileCache-class.html">BiocFileCache</a></span><span class="op">(</span><span class="st">"raw_data"</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">raw.path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocFileCache/man/BiocFileCache-class.html">bfcrpath</a></span><span class="op">(</span><span class="va">bfc</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span>
  <span class="st">"http://cf.10xgenomics.com/samples"</span>,
  <span class="st">"cell-exp/2.1.0/pbmc4k/pbmc4k_raw_gene_bc_matrices.tar.gz"</span>
<span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/untar.html">untar</a></span><span class="op">(</span><span class="va">raw.path</span>, exdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"pbmc4k"</span><span class="op">)</span><span class="op">)</span>

<span class="va">fname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"pbmc4k/raw_gene_bc_matrices/GRCh38"</span><span class="op">)</span>
<span class="va">pbmc4k.droplet</span> <span class="op">&lt;-</span> <span class="fu">DropletUtils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DropletUtils/man/read10xCounts.html">read10xCounts</a></span><span class="op">(</span><span class="va">fname</span>, col.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co">### change the sample column</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">pbmc4k.droplet</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sample"</span>, <span class="st">"Barcode"</span><span class="op">)</span>
<span class="fu">colData</span><span class="op">(</span><span class="va">pbmc4k.droplet</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"pbmc4k"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">pbmc4k.droplet</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>singleCellTK also supports the importing of single-cell data from the following platforms: <a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/what-is-cell-ranger">10X CellRanger</a>, <a href="https://github.com/alexdobin/STAR/blob/master/docs/STARsolo.md">STARSolo</a>, <a href="https://www.kallistobus.tools/">BUSTools</a>, <a href="https://github.com/ambrosejcarr/seqc">SEQC</a>, <a href="https://github.com/hms-dbmi/dropEst">DropEST</a>, and <a href="https://github.com/theislab/anndata">AnnData</a>. To load your own input data, please refer <a href="./import_scRNAseq_data_as_SCE_Console.html">Import data into SCTK</a> for deailed instruction.</p>
</div>
<div id="rundropletqc" class="section level3">
<h3 class="hasAnchor">
<a href="#rundropletqc" class="anchor"></a>runDropletQC</h3>
<p>All droplet-based QC functions are able to be run under the wrapper function runDropletQC. By default all possible QC algorithms will be run.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc4k.droplet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runDropletQC.html">runDropletQC</a></span><span class="op">(</span><span class="va">pbmc4k.droplet</span><span class="op">)</span></code></pre></div>
<pre><code>## Thu Apr 01 19:25:40 2021 ... Running 'perCellQCMetrics'</code></pre>
<pre><code>## Thu Apr 01 19:25:43 2021 ... Running 'emptyDrops'</code></pre>
<pre><code>## Thu Apr 01 19:26:54 2021 ... Running 'barcodeRanks'</code></pre>
<p>If users choose to only run a specific set of algorithms, they can specify which to run with the algorithms parameter.</p>
<p>When quality control functions are run in singleCellTK, the output of the function is stored in the colData slot of the SingleCellExperiment object.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">pbmc4k.droplet</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">pbmc4k.droplet</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span>
<span class="va">df.matrix</span> <span class="op">%&gt;%</span>
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/scroll_box.html">scroll_box</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"80%"</span><span class="op">)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:80%; ">
<table class="table table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
sample
</th>
<th style="text-align:left;">
Barcode
</th>
<th style="text-align:right;">
sum
</th>
<th style="text-align:right;">
detected
</th>
<th style="text-align:right;">
percent.top_50
</th>
<th style="text-align:right;">
percent.top_100
</th>
<th style="text-align:right;">
percent.top_200
</th>
<th style="text-align:right;">
percent.top_500
</th>
<th style="text-align:right;">
total
</th>
<th style="text-align:right;">
dropletUtils_emptyDrops_total
</th>
<th style="text-align:right;">
dropletUtils_emptyDrops_logprob
</th>
<th style="text-align:right;">
dropletUtils_emptyDrops_pvalue
</th>
<th style="text-align:left;">
dropletUtils_emptyDrops_limited
</th>
<th style="text-align:right;">
dropletUtils_emptyDrops_fdr
</th>
<th style="text-align:right;">
dropletUtils_BarcodeRank_Knee
</th>
<th style="text-align:right;">
dropletUtils_BarcodeRank_Inflection
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
AAACCTGAGAAACCAT-1
</td>
<td style="text-align:left;">
pbmc4k
</td>
<td style="text-align:left;">
AAACCTGAGAAACCAT-1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
AAACCTGAGAAACCGC-1
</td>
<td style="text-align:left;">
pbmc4k
</td>
<td style="text-align:left;">
AAACCTGAGAAACCGC-1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
AAACCTGAGAAACCTA-1
</td>
<td style="text-align:left;">
pbmc4k
</td>
<td style="text-align:left;">
AAACCTGAGAAACCTA-1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
AAACCTGAGAAACGAG-1
</td>
<td style="text-align:left;">
pbmc4k
</td>
<td style="text-align:left;">
AAACCTGAGAAACGAG-1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
AAACCTGAGAAACGCC-1
</td>
<td style="text-align:left;">
pbmc4k
</td>
<td style="text-align:left;">
AAACCTGAGAAACGCC-1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<p>A summary of all outputs is shown below:</p>
<table class="table">
<colgroup>
<col width="27%">
<col width="46%">
<col width="14%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">QC output</th>
<th align="left">Description</th>
<th align="left">Methods</th>
<th align="left">Package/Tool</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">dropletUtils_emptyDrops_total</td>
<td align="left">Total counts</td>
<td align="left">runEmptyDrops</td>
<td align="left">DropletUtils</td>
</tr>
<tr class="even">
<td align="left">dropletUtils_emptyDrops_logprob</td>
<td align="left">The log-probability of droplet being empty</td>
<td align="left">runEmptyDrops</td>
<td align="left">DropletUtils</td>
</tr>
<tr class="odd">
<td align="left">dropletUtils_emptyDrops_pvalue</td>
<td align="left">Monte Carlo p-value of droplet being empty</td>
<td align="left">runEmptyDrops</td>
<td align="left">DropletUtils</td>
</tr>
<tr class="even">
<td align="left">dropletUtils_emptyDrops_limited</td>
<td align="left">Whether a lower p-value could be obtained by increasing niters</td>
<td align="left">runEmptyDrops</td>
<td align="left">DropletUtils</td>
</tr>
<tr class="odd">
<td align="left">dropletUtils_emptyDrops_fdr</td>
<td align="left">p-value of droplet being empty, corrected for false detection rate</td>
<td align="left">runEmptyDrops</td>
<td align="left">DropletUtils</td>
</tr>
<tr class="even">
<td align="left">dropletUtils_BarcodeRank_Knee</td>
<td align="left">Whether total UMI count value is higher than knee point</td>
<td align="left">runBarcodeRankDrops</td>
<td align="left">DropletUtils</td>
</tr>
<tr class="odd">
<td align="left">dropletUtils_BarcodeRank_Inflection</td>
<td align="left">Whether total UMI count value is higher than inflection point</td>
<td align="left">runBarcodeRankDrops</td>
<td align="left">DropletUtils</td>
</tr>
</tbody>
</table>
</div>
<div id="plotting-qc-metrics" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-qc-metrics" class="anchor"></a>Plotting QC metrics</h3>
<p>Upon running runDropletQC, the QC outputs will need to be plotted. For each QC method, singleCellTK contains specialized plotting functions that may be used for the generation of QC plots.</p>
<div id="emptydrops" class="section level4">
<h4 class="hasAnchor">
<a href="#emptydrops" class="anchor"></a>EmptyDrops</h4>
<p>It is crucial to distinguish the data occurring from real cells and empty droplets containing ambient RNA. SCTK employs the <a href="https://rdrr.io/github/MarioniLab/DropletUtils/man/emptyDrops.html">EmptyDrops</a> algorithm from the <a href="https://bioconductor.org/packages/release/bioc/html/DropletUtils.html">DropletUtils</a> package to test for empty droplets.</p>
<p>The wrapper function <code>plotEmptyDropsResults</code> can be used to plot the results from the EmptyDrops algorithm. This will visualize the empty droplets, by plotting the total UMI counts against the log probability for each barcode.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">emptyDropsResults</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotEmptyDropsResults.html">plotEmptyDropsResults</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc4k.droplet</span>,
  axisLabelSize <span class="op">=</span> <span class="fl">20</span>,
  sample <span class="op">=</span> <span class="cn">NULL</span>,
  fdrCutoff <span class="op">=</span> <span class="fl">0.01</span>,
  dotSize <span class="op">=</span> <span class="fl">0.5</span>,
  defaultTheme <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">emptyDropsResults</span><span class="op">$</span><span class="va">scatterEmptyDrops</span></code></pre></div>
<p><img src="cnsl_qc_files/figure-html/scatter_emptydrops-1.png" width="768" style="display: block; margin: auto;"><br> Data points are colored by FDR values, where we see a small portion of the dataset contains barcodes that do not meet the threshold.</p>
</div>
<div id="barcoderanks" class="section level4">
<h4 class="hasAnchor">
<a href="#barcoderanks" class="anchor"></a>BarcodeRanks</h4>
<p><a href="https://rdrr.io/bioc/DropletUtils/man/barcodeRanks.html">BarcodeRanks</a> from the <a href="https://bioconductor.org/packages/release/bioc/html/DropletUtils.html">DropletUtils</a> package computes barcode rank statistics and identifies the knee and inflection points on the total count curve. The knee and inflection points on the curve represent the difference between empty droplets and cell-containing droplets with much more RNA. The lower parameter is again the lower bound of the total UMI count, in which all barcodes below the lower bound are assumed to be empty droplets.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotBarcodeRankScatter.html">plotBarcodeRankScatter</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc4k.droplet</span>,
  title <span class="op">=</span> <span class="st">"BarcodeRanks Rank Plot"</span>,
  legendSize <span class="op">=</span> <span class="fl">14</span>
<span class="op">)</span></code></pre></div>
<p><img src="cnsl_qc_files/figure-html/run_kneeplot_barcoderank-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The total UMI count of each barcode is plotted against its rank, where we see a steep dropoff of UMI counts around the inflection point, where we see a separation between cell containing and empty droplets.</p>
</div>
</div>
<div id="filtering-the-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#filtering-the-dataset" class="anchor"></a>Filtering the dataset</h3>
<p>SingleCellExperiment objects can be subset by its colData using <code>subsetSCECols</code>. The <code>colData</code> parameter takes in an expression in character vector form which will be used to identify a subset of columns using variables found in the colData of the SingleCellExperiment object. For example, if x is a numeric vector in colData, then “x &lt; 5” will return all columns with x less than 5. The <code>index</code> parameter takes in a vector of indices which should be kept, while <code>bool</code> takes in a vector of TRUE or FALSE which should be the same length as the number of columns in the SingleCellExperiment object.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Before filtering:</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">pbmc4k.droplet</span><span class="op">)</span></code></pre></div>
<pre><code>## [1]  33694 737280</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc4k.droplet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subsetSCECols.html">subsetSCECols</a></span><span class="op">(</span><span class="va">pbmc4k.droplet</span>, colData <span class="op">=</span> <span class="st">'dropletUtils_BarcodeRank_Inflection == 1'</span><span class="op">)</span>
<span class="va">pbmc4k.droplet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subsetSCECols.html">subsetSCECols</a></span><span class="op">(</span><span class="va">pbmc4k.droplet</span>, colData <span class="op">=</span> <span class="st">'!is.na(pbmc4k.droplet$dropletUtils_emptyDrops_fdr)'</span><span class="op">)</span>
<span class="va">pbmc4k.droplet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subsetSCECols.html">subsetSCECols</a></span><span class="op">(</span><span class="va">pbmc4k.droplet</span>, colData <span class="op">=</span> <span class="st">'pbmc4k.droplet$dropletUtils_emptyDrops_fdr &lt; 0.01'</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#After filtering:</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">pbmc4k.droplet</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 33694  4236</code></pre>
<p>We can compare the average total UMI counts per cell before and after cell filtration:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotSCEViolinColData.html">plotSCEViolinColData</a></span><span class="op">(</span><span class="va">pbmc4k.droplet.prefilt</span>, coldata <span class="op">=</span> <span class="st">"sum"</span>, summary <span class="op">=</span> <span class="st">"mean"</span>, title <span class="op">=</span> <span class="st">"Pre-filter"</span>, ylab <span class="op">=</span> <span class="st">"Total counts"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotSCEViolinColData.html">plotSCEViolinColData</a></span><span class="op">(</span><span class="va">pbmc4k.droplet</span>, coldata <span class="op">=</span> <span class="st">"sum"</span>, summary <span class="op">=</span> <span class="st">"mean"</span>, title <span class="op">=</span> <span class="st">"Post-filter"</span>, ylab <span class="op">=</span> <span class="st">"Total counts"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="cnsl_qc_files/figure-html/Count%20Violin%20after%20filtering-1.png" width="576" style="display: block; margin: auto;"></p>
<p>For additional cell-filtered quality control with singleCellTK, please refer to “Running quality control of cell-filtered single cell data with singleCellTK”.</p>
</div>
<div id="running-individual-qc-methods" class="section level3">
<h3 class="hasAnchor">
<a href="#running-individual-qc-methods" class="anchor"></a>Running individual QC methods</h3>
<p>Instead of running all quality control methods on the dataset at once, users may elect to execute QC methods individually. The parameters as well as the outputs to individual QC functions are described in detail as follows:</p>
<div id="runemptydrops" class="section level4">
<h4 class="hasAnchor">
<a href="#runemptydrops" class="anchor"></a>runEmptyDrops</h4>
<p>The wrapper function <code>runEmptyDrops</code> can be used to separately run the EmptyDrops algorithm on its own.</p>
<p>In runEmptyDrops, the <code>lower</code> parameter is the lower bound of the total UMI count, in which all barcodes below the lower bound are assumed to be empty droplets. The <code>niters</code> parameter is the number of iterations the function will run for the calculation. <code>testAmbient</code> indicates whether results should be returned for barcodes that have a total UMI count below what is specified in <code>lower</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc4k.droplet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runEmptyDrops.html">runEmptyDrops</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc4k.droplet</span>,
  useAssay <span class="op">=</span> <span class="st">"counts"</span>,
  lower <span class="op">=</span> <span class="fl">100</span>,
  niters <span class="op">=</span> <span class="fl">10000</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="runbarcoderankdrops" class="section level4">
<h4 class="hasAnchor">
<a href="#runbarcoderankdrops" class="anchor"></a>runBarcodeRankDrops</h4>
<p>The wrapper function <code>runBarcodeRankDrops</code> can be used to separately run the BarcodeRanks algorithm on its own.</p>
<p>The <code>lower</code> parameter is again the lower bound of the total UMI count, in which all barcodes below the lower bound are assumed to be empty droplets.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc4k.droplet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runBarcodeRankDrops.html">runBarcodeRankDrops</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc4k.droplet</span>,
  useAssay <span class="op">=</span> <span class="st">"counts"</span>,
  fitBounds <span class="op">=</span> <span class="cn">NULL</span>, df <span class="op">=</span> <span class="fl">20</span>
<span class="op">)</span></code></pre></div>
<p><br><br></p>
</div>
</div>
</div>
<div id="running-quality-control-of-cell-filtered-single-cell-data-with-singlecelltk" class="section level2">
<h2 class="hasAnchor">
<a href="#running-quality-control-of-cell-filtered-single-cell-data-with-singlecelltk" class="anchor"></a>Running quality control of cell-filtered single cell data with singleCellTK</h2>
<div id="load-pbmc-data-from-10x" class="section level3">
<h3 class="hasAnchor">
<a href="#load-pbmc-data-from-10x" class="anchor"></a>Load PBMC data from 10X</h3>
<p>We will use a filtered form of the PBMC 3K and 6K dataset from the package <a href="http://bioconductor.org/packages/release/data/experiment/html/TENxPBMCData.html">TENxPBMCData</a>, which is available from the <code>importExampleData</code> function. We will combine these datasets together into a single SingleCellExperiment object.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc3k</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/importExampleData.html">importExampleData</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"pbmc3k"</span><span class="op">)</span>
<span class="va">pbmc6k</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/importExampleData.html">importExampleData</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"pbmc6k"</span><span class="op">)</span>

<span class="va">pbmc.combined</span> <span class="op">&lt;-</span> <span class="fu">BiocGenerics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html">cbind</a></span><span class="op">(</span><span class="va">pbmc3k</span>, <span class="va">pbmc6k</span><span class="op">)</span>

<span class="va">sample.vector</span> <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span></code></pre></div>
<p>singleCellTK also supports the importing of single-cell data from the following platforms: <a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/what-is-cell-ranger">10X CellRanger</a>, <a href="https://github.com/alexdobin/STAR/blob/master/docs/STARsolo.md">STARSolo</a>, <a href="https://www.kallistobus.tools/">BUSTools</a>, <a href="https://github.com/ambrosejcarr/seqc">SEQC</a>, <a href="https://github.com/hms-dbmi/dropEst">DropEST</a>, and <a href="https://github.com/theislab/anndata">AnnData</a>. To load your own input data, please refer <a href="./import_scRNAseq_data_as_SCE_Console.html">Import data into SCTK</a> for deailed instruction.</p>
</div>
<div id="run-dimensionality-reduction" class="section level3">
<h3 class="hasAnchor">
<a href="#run-dimensionality-reduction" class="anchor"></a>Run Dimensionality Reduction</h3>
<p>SCTK utilizes dimensionality reduction techniques such as TSNE and UMAP for visualizing single-cell data. The user can modify the dimensions by adjusting the parameters within the function. The <code>logNorm</code> parameter should be set to TRUE for normalization prior to running dimensionality reduction.</p>
<p>The <code>sample</code> parameter may be specified if multiple samples exist in the SingleCellExperiment object. Here, we will use the sample vector stored in the colData of the SingleCellExperiment object.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># UMAP:</span>
<span class="va">pbmc.combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getUMAP.html">getUMAP</a></span><span class="op">(</span>inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>, useAssay <span class="op">=</span> <span class="st">"counts"</span>, logNorm <span class="op">=</span> <span class="cn">TRUE</span>, sample <span class="op">=</span> <span class="va">sample.vector</span><span class="op">)</span>

<span class="co"># TSNE (not run):</span>
<span class="co"># pbmc &lt;- getTSNE(inSCE=pbmc, useAssay="counts", logNorm = TRUE, sample = colData(pbmc)$sample)</span></code></pre></div>
</div>
<div id="runcellqc" class="section level3">
<h3 class="hasAnchor">
<a href="#runcellqc" class="anchor"></a>runCellQC</h3>
<p>All of the droplet-based QC algorithms are able to be run under the wrapper function <code>runCellQC</code>. By default all possible QC algorithms will be run.</p>
<p>Users may set a <code>sample</code> parameter if you would like to compare between multiple samples. Here, we will use the sample vector stored in the SingleCellExperiment object.</p>
<p>If the user wishes, a list of gene sets can be applied to the function to determine the expression of a set of specific genes. A gene list imported into the SingleCellExperiment object using <code>importGeneSets</code> functions can be set as <code>collectionName</code>. Additionally, a pre-made list of genes can be used to determine the level of gene expression per cell. A list containing gene symbols may be set as <code>geneSetList</code>, or the user may instead use the <code>geneSetCollection</code> parameter to supply a <code>GeneSetCollection</code> object from the <a href="https://bioconductor.org/packages/release/bioc/html/GSEABase.html">GSEABase</a> package.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc.combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/importGeneSetsFromGMT.html">importGeneSetsFromGMT</a></span><span class="op">(</span>inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>, collectionName <span class="op">=</span> <span class="st">"mito"</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/mito_subset.gmt"</span>, package <span class="op">=</span> <span class="st">"singleCellTK"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>
<span class="va">pbmc.combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCellQC.html">runCellQC</a></span><span class="op">(</span><span class="va">pbmc.combined</span>, sample <span class="op">=</span> <span class="va">sample.vector</span>, collectionName <span class="op">=</span> <span class="st">"mito"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Creating 900 artificial doublets..."</code></pre>
<pre><code>## Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric
## To use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'
## This message will be shown once per session</code></pre>
<pre><code>## [1] "Creating 1806 artificial doublets..."
## [19:40:52] WARNING: amalgamation/../src/learner.cc:1061: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
## [19:41:25] WARNING: amalgamation/../src/learner.cc:1061: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
## [19:41:43] WARNING: amalgamation/../src/learner.cc:1061: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
## [19:42:14] WARNING: amalgamation/../src/learner.cc:1061: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.</code></pre>
<p>If users choose to only run a specific set of algorithms, they can specify which to run with the <code>algorithms</code> parameter.</p>
<p>When quality control functions are run in singleCellTK, the output of the function is stored in the <code>colData</code> slot of the <code>SingleCellExperiment</code> object.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:80%; ">
<table class="table table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Sample
</th>
<th style="text-align:left;">
Barcode
</th>
<th style="text-align:left;">
Sequence
</th>
<th style="text-align:right;">
Library
</th>
<th style="text-align:left;">
Cell_ranger_version
</th>
<th style="text-align:left;">
Tissue_status
</th>
<th style="text-align:left;">
Barcode_type
</th>
<th style="text-align:left;">
Chemistry
</th>
<th style="text-align:left;">
Sequence_platform
</th>
<th style="text-align:left;">
Individual
</th>
<th style="text-align:left;">
Date_published
</th>
<th style="text-align:left;">
sample
</th>
<th style="text-align:right;">
sum
</th>
<th style="text-align:right;">
detected
</th>
<th style="text-align:right;">
percent.top_50
</th>
<th style="text-align:right;">
percent.top_100
</th>
<th style="text-align:right;">
percent.top_200
</th>
<th style="text-align:right;">
percent.top_500
</th>
<th style="text-align:right;">
subsets_mito_sum
</th>
<th style="text-align:right;">
subsets_mito_detected
</th>
<th style="text-align:right;">
subsets_mito_percent
</th>
<th style="text-align:right;">
total
</th>
<th style="text-align:right;">
scrublet_score
</th>
<th style="text-align:left;">
scrublet_call
</th>
<th style="text-align:left;">
scDblFinder_sample
</th>
<th style="text-align:right;">
scDblFinder_cluster
</th>
<th style="text-align:left;">
scDblFinder_class
</th>
<th style="text-align:right;">
scDblFinder_doublet_score
</th>
<th style="text-align:right;">
scDblFinder_ratio
</th>
<th style="text-align:right;">
scDblFinder_weighted
</th>
<th style="text-align:left;">
scDblFinder_nearestClass
</th>
<th style="text-align:right;">
scDblFinder_difficulty
</th>
<th style="text-align:right;">
scDblFinder_cxds_score
</th>
<th style="text-align:left;">
scDblFinder_mostLikelyOrigin
</th>
<th style="text-align:left;">
scDblFinder_originAmbiguous
</th>
<th style="text-align:right;">
doubletFinder_doublet_score_resolution_1.5
</th>
<th style="text-align:left;">
doubletFinder_doublet_label_resolution_1.5
</th>
<th style="text-align:right;">
scds_cxds_score
</th>
<th style="text-align:left;">
scds_cxds_call
</th>
<th style="text-align:right;">
scds_bcds_score
</th>
<th style="text-align:left;">
scds_bcds_call
</th>
<th style="text-align:right;">
scds_hybrid_score
</th>
<th style="text-align:left;">
scds_hybrid_call
</th>
<th style="text-align:right;">
decontX_contamination
</th>
<th style="text-align:left;">
decontX_clusters
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
pbmc3k_AAACATACAACCAC-1
</td>
<td style="text-align:left;">
pbmc3k
</td>
<td style="text-align:left;">
AAACATACAACCAC-1
</td>
<td style="text-align:left;">
AAACATACAACCAC
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
v1.1.0
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
GemCode
</td>
<td style="text-align:left;">
Chromium_v1
</td>
<td style="text-align:left;">
NextSeq500
</td>
<td style="text-align:left;">
HealthyDonor2
</td>
<td style="text-align:left;">
2016-05-26
</td>
<td style="text-align:left;">
pbmc3k
</td>
<td style="text-align:right;">
2421
</td>
<td style="text-align:right;">
781
</td>
<td style="text-align:right;">
47.74886
</td>
<td style="text-align:right;">
63.27964
</td>
<td style="text-align:right;">
74.96902
</td>
<td style="text-align:right;">
88.39323
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
3.015283
</td>
<td style="text-align:right;">
2421
</td>
<td style="text-align:right;">
0.1606218
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
pbmc3k
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
singlet
</td>
<td style="text-align:right;">
0.5404512
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.8295422
</td>
<td style="text-align:left;">
artificialDoublet
</td>
<td style="text-align:right;">
0.1078092
</td>
<td style="text-align:right;">
0.0248409
</td>
<td style="text-align:left;">
1+2
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0.0138889
</td>
<td style="text-align:left;">
Singlet
</td>
<td style="text-align:right;">
22794.14
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0.0149839
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0.2109824
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0.0333002
</td>
<td style="text-align:left;">
pbmc3k-1
</td>
</tr>
<tr>
<td style="text-align:left;">
pbmc3k_AAACATTGAGCTAC-1
</td>
<td style="text-align:left;">
pbmc3k
</td>
<td style="text-align:left;">
AAACATTGAGCTAC-1
</td>
<td style="text-align:left;">
AAACATTGAGCTAC
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
v1.1.0
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
GemCode
</td>
<td style="text-align:left;">
Chromium_v1
</td>
<td style="text-align:left;">
NextSeq500
</td>
<td style="text-align:left;">
HealthyDonor2
</td>
<td style="text-align:left;">
2016-05-26
</td>
<td style="text-align:left;">
pbmc3k
</td>
<td style="text-align:right;">
4903
</td>
<td style="text-align:right;">
1352
</td>
<td style="text-align:right;">
45.50275
</td>
<td style="text-align:right;">
61.02386
</td>
<td style="text-align:right;">
71.81318
</td>
<td style="text-align:right;">
82.62288
</td>
<td style="text-align:right;">
186
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
3.793596
</td>
<td style="text-align:right;">
4903
</td>
<td style="text-align:right;">
0.1147541
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
pbmc3k
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
singlet
</td>
<td style="text-align:right;">
0.2076700
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
0.5434718
</td>
<td style="text-align:left;">
artificialDoublet
</td>
<td style="text-align:right;">
0.0333764
</td>
<td style="text-align:right;">
0.1137545
</td>
<td style="text-align:left;">
1+4
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0.1527778
</td>
<td style="text-align:left;">
Singlet
</td>
<td style="text-align:right;">
35689.05
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0.9710556
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
0.8471188
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0.1377323
</td>
<td style="text-align:left;">
pbmc3k-2
</td>
</tr>
</tbody>
</table>
</div>
<p>A summary of all outputs is shown below:</p>
<table class="table">
<colgroup>
<col width="29%">
<col width="45%">
<col width="13%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th>QC output</th>
<th align="left">Description</th>
<th align="left">Methods</th>
<th align="left">Package/Tool</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>sum</td>
<td align="left">Total counts</td>
<td align="left">runPerCellQC</td>
<td align="left">scater</td>
</tr>
<tr class="even">
<td>detected</td>
<td align="left">Total features</td>
<td align="left">runPerCellQC</td>
<td align="left">scater</td>
</tr>
<tr class="odd">
<td>percent_top</td>
<td align="left">% Expression coming from top features</td>
<td align="left">runPerCellQC</td>
<td align="left">scater</td>
</tr>
<tr class="even">
<td>subsets_</td>
<td align="left">sum, detected, percent_top calculated on specified gene list</td>
<td align="left">runPerCellQC</td>
<td align="left">scater</td>
</tr>
<tr class="odd">
<td>scrublet_score</td>
<td align="left">Doublet score</td>
<td align="left">runScrublet</td>
<td align="left">scrublet</td>
</tr>
<tr class="even">
<td>scrublet_call</td>
<td align="left">Doublet classification based on threshold</td>
<td align="left">runScrublet</td>
<td align="left">scrublet</td>
</tr>
<tr class="odd">
<td>scDblFinder_doublet_score</td>
<td align="left">Doublet score</td>
<td align="left">runScDblFinder</td>
<td align="left">scran</td>
</tr>
<tr class="even">
<td>doubletFinder_doublet_score</td>
<td align="left">Doublet score</td>
<td align="left">runDoubletFinder</td>
<td align="left">DoubletFinder</td>
</tr>
<tr class="odd">
<td>doubletFinder_doublet_label_resolution</td>
<td align="left">Doublet classification based on threshold</td>
<td align="left">runDoubletFinder</td>
<td align="left">DoubletFinder</td>
</tr>
<tr class="even">
<td>scds_cxds_score</td>
<td align="left">Doublet score</td>
<td align="left">runCxds</td>
<td align="left">SCDS</td>
</tr>
<tr class="odd">
<td>scds_cxds_call</td>
<td align="left">Doublet classification based on threshold</td>
<td align="left">runCxds</td>
<td align="left">SCDS</td>
</tr>
<tr class="even">
<td>scds_bcds_score</td>
<td align="left">Doublet score</td>
<td align="left">runBcds</td>
<td align="left">SCDS</td>
</tr>
<tr class="odd">
<td>scds_bcds_call</td>
<td align="left">Doublet classification based on threshold</td>
<td align="left">runBcds</td>
<td align="left">SCDS</td>
</tr>
<tr class="even">
<td>scds_hybrid_score</td>
<td align="left">Doublet score</td>
<td align="left">runCxdsBcdsHybrid</td>
<td align="left">SCDS</td>
</tr>
<tr class="odd">
<td>scds_hybrid_call</td>
<td align="left">Doublet classification based on threshold</td>
<td align="left">runCxdsBcdsHybrid</td>
<td align="left">SCDS</td>
</tr>
<tr class="even">
<td>decontX_contamination</td>
<td align="left">Ambient RNA contamination</td>
<td align="left">runDecontX</td>
<td align="left">celda</td>
</tr>
<tr class="odd">
<td>decontX_clusters</td>
<td align="left">Clusters determined in dataset based on underlying algorithm</td>
<td align="left">runDecontX</td>
<td align="left">celda</td>
</tr>
</tbody>
</table>
<p>The names of the reducedDims of the <code>SingleCellExperiment</code> object are stored in the <code>reducedDims</code> slot.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">reducedDims</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span></code></pre></div>
<pre><code>## List of length 6
## names(6): UMAP scrublet_TSNE ... decontX_pbmc3k_UMAP decontX_pbmc6k_UMAP</code></pre>
<p><br></p>
</div>
<div id="plotting-qc-metrics-1" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-qc-metrics-1" class="anchor"></a>Plotting QC metrics</h3>
<p>Upon running runCellQC, the QC outputs will need to be plotted. For each QC method, singleCellTK contains specialized plotting functions that may be used for the generation of QC plots.</p>
<div id="general-qc-metrics" class="section level4">
<h4 class="hasAnchor">
<a href="#general-qc-metrics" class="anchor"></a>General QC metrics</h4>
<div id="runpercellqc" class="section level5">
<h5 class="hasAnchor">
<a href="#runpercellqc" class="anchor"></a>runPerCellQC</h5>
<p>SingleCellTK utilizes the <a href="https://bioconductor.org/packages/release/bioc/html/scater.html">scater</a> package to compute cell-level QC metrics.</p>
<p>The wrapper function plotRunPerCellQCResults can be used to plot the general QC outputs.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">runpercellqc.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotRunPerCellQCResults.html">plotRunPerCellQCResults</a></span><span class="op">(</span>inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>, sample <span class="op">=</span> <span class="va">sample.vector</span>, combinePlot <span class="op">=</span> <span class="st">"all"</span>, axisSize <span class="op">=</span> <span class="fl">8</span>, axisLabelSize <span class="op">=</span> <span class="fl">9</span>, titleSize <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">runpercellqc.results</span></code></pre></div>
<p><img src="cnsl_qc_files/figure-html/unnamed-chunk-6-1.png" width="960"></p>
</div>
</div>
<div id="doublet-detection" class="section level4">
<h4 class="hasAnchor">
<a href="#doublet-detection" class="anchor"></a>Doublet detection</h4>
<p>Doublets hinder cell-type identification by appearing as a distinct transcriptomic state, and need to be removed for downstream analysis. singleCellTK contains various doublet detection tools that the user may choose from.</p>
<div id="scrublet" class="section level5">
<h5 class="hasAnchor">
<a href="#scrublet" class="anchor"></a>Scrublet</h5>
<p><a href="https://github.com/swolock/scrublet/blob/master/examples/scrublet_basics.ipynb">Scrublet</a> aims to detect doublets by creating simulated doublets from combining transcriptomic profiles of existing cells in the dataset.</p>
<p>The wrapper function <code>plotScrubletResults</code> can be used to plot the results from the Scrublet algorithm.</p>
<p>The names of the reducedDims of the <code>SingleCellExperiment</code> object are stored in the <code>reducedDims</code> slot. Here, we will use the UMAP coordinates generated from <code>getUMAP</code> above.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">reducedDims</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span></code></pre></div>
<pre><code>## List of length 6
## names(6): UMAP scrublet_TSNE ... decontX_pbmc3k_UMAP decontX_pbmc6k_UMAP</code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scrublet.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotScrubletResults.html">plotScrubletResults</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>,
  reducedDimName <span class="op">=</span> <span class="st">"UMAP"</span>,
  sample <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span>, 
  combinePlot <span class="op">=</span> <span class="st">"all"</span>,
  titleSize <span class="op">=</span> <span class="fl">13</span>,
  axisLabelSize <span class="op">=</span> <span class="fl">13</span>,
  axisSize <span class="op">=</span> <span class="fl">13</span>,
  legendSize <span class="op">=</span> <span class="fl">13</span>,
  legendTitleSize <span class="op">=</span> <span class="fl">13</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scrublet.results</span> </code></pre></div>
<p><img src="cnsl_qc_files/figure-html/plot_umap_scrublet-1.png" width="960"></p>
</div>
<div id="scdblfinder" class="section level5">
<h5 class="hasAnchor">
<a href="#scdblfinder" class="anchor"></a>ScDblFinder</h5>
<p><a href="https://rdrr.io/bioc/scDblFinder/">ScDblFinder</a> is a doublet detection algorithm. ScDblFinder aims to detect doublets by creating a simulated doublet from existing cells and projecting it to the same PCA space as the cells.</p>
<p>The wrapper function plotScDblFinderResults can be used to plot the QC outputs from the ScDblFinder algorithm.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scDblFinder.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotScDblFinderResults.html">plotScDblFinderResults</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>, sample <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span>, 
  reducedDimName <span class="op">=</span> <span class="st">"UMAP"</span>, combinePlot <span class="op">=</span> <span class="st">"all"</span>,
  titleSize <span class="op">=</span> <span class="fl">13</span>,
  axisLabelSize <span class="op">=</span> <span class="fl">13</span>,
  axisSize <span class="op">=</span> <span class="fl">13</span>,
  legendSize <span class="op">=</span> <span class="fl">13</span>,
  legendTitleSize <span class="op">=</span> <span class="fl">13</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scDblFinder.results</span></code></pre></div>
<p><img src="cnsl_qc_files/figure-html/plot_umap_scDblFinder-1.png" width="960"></p>
</div>
<div id="doubletfinder" class="section level5">
<h5 class="hasAnchor">
<a href="#doubletfinder" class="anchor"></a>DoubletFinder</h5>
<p><a href="https://github.com/chris-mcginnis-ucsf/DoubletFinder">DoubletFinder</a> is a doublet detection algorithm which depends on the single cell analysis package Seurat.</p>
<p>The wrapper function plotDoubletFinderResults can be used to plot the QC outputs from the DoubletFinder algorithm.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">doubletFinderResults</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotDoubletFinderResults.html">plotDoubletFinderResults</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>,
  sample <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span>, 
  reducedDimName <span class="op">=</span> <span class="st">"UMAP"</span>,
  combinePlot <span class="op">=</span> <span class="st">"all"</span>,
  titleSize <span class="op">=</span> <span class="fl">13</span>,
  axisLabelSize <span class="op">=</span> <span class="fl">13</span>,
  axisSize <span class="op">=</span> <span class="fl">13</span>,
  legendSize <span class="op">=</span> <span class="fl">13</span>,
  legendTitleSize <span class="op">=</span> <span class="fl">13</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">doubletFinderResults</span> </code></pre></div>
<p><img src="cnsl_qc_files/figure-html/plot_umap_doubletfinder-1.png" width="1056"></p>
</div>
<div id="scds-cxds" class="section level5">
<h5 class="hasAnchor">
<a href="#scds-cxds" class="anchor"></a>SCDS, CXDS</h5>
<p>CXDS, or co-expression based doublet scoring, is an algorithm in the <a href="https://www.bioconductor.org/packages/release/bioc/html/scds.html">SCDS</a> package which employs a binomial model for the co-expression of pairs of genes to determine doublets.</p>
<p>The wrapper function <code>plotCxdsResults</code> can be used to plot the QC outputs from the CXDS algorithm.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cxdsResults</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCxdsResults.html">plotCxdsResults</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>,
  sample <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span>, 
  reducedDimName <span class="op">=</span> <span class="st">"UMAP"</span>, combinePlot <span class="op">=</span> <span class="st">"all"</span>,
  titleSize <span class="op">=</span> <span class="fl">13</span>,
  axisLabelSize <span class="op">=</span> <span class="fl">13</span>,
  axisSize <span class="op">=</span> <span class="fl">13</span>,
  legendSize <span class="op">=</span> <span class="fl">13</span>,
  legendTitleSize <span class="op">=</span> <span class="fl">13</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cxdsResults</span></code></pre></div>
<p><img src="cnsl_qc_files/figure-html/plot_umap_cxds-1.png" width="1056"></p>
</div>
<div id="scds-bcds" class="section level5">
<h5 class="hasAnchor">
<a href="#scds-bcds" class="anchor"></a>SCDS, BCDS</h5>
<p>BCDS, or binary classification based doublet scoring, is an algorithm in the <a href="https://www.bioconductor.org/packages/release/bioc/html/scds.html">SCDS</a> package which uses a binary classification approach to determine doublets.</p>
<p>The wrapper function plotBCDSResults can be used to plot the QC outputs from the BCDS algorithm</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bcdsResults</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotBcdsResults.html">plotBcdsResults</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>,
  sample <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span>, 
  reducedDimName <span class="op">=</span> <span class="st">"UMAP"</span>, combinePlot <span class="op">=</span> <span class="st">"all"</span>,
  titleSize <span class="op">=</span> <span class="fl">13</span>,
  axisLabelSize <span class="op">=</span> <span class="fl">13</span>,
  axisSize <span class="op">=</span> <span class="fl">13</span>,
  legendSize <span class="op">=</span> <span class="fl">13</span>,
  legendTitleSize <span class="op">=</span> <span class="fl">13</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bcdsResults</span></code></pre></div>
<p><img src="cnsl_qc_files/figure-html/plot_umap_bcds-1.png" width="1056"></p>
</div>
<div id="scds-cxds-bcds-hybrid" class="section level5">
<h5 class="hasAnchor">
<a href="#scds-cxds-bcds-hybrid" class="anchor"></a>SCDS, CXDS-BCDS hybrid</h5>
<p>The CXDS-BCDS hybrid algorithm, uses both CXDS and BCDS algorithms from the <a href="https://www.bioconductor.org/packages/release/bioc/html/scds.html">SCDS</a> package.</p>
<p>The wrapper function plotScdsHybridResults can be used to plot the QC outputs from the CXDS-BCDS hybrid algorithm.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bcdsCxdsHybridResults</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotScdsHybridResults.html">plotScdsHybridResults</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>, sample <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span>, 
  reducedDimName <span class="op">=</span> <span class="st">"UMAP"</span>, combinePlot <span class="op">=</span> <span class="st">"all"</span>,
  titleSize <span class="op">=</span> <span class="fl">13</span>,
  axisLabelSize <span class="op">=</span> <span class="fl">13</span>,
  axisSize <span class="op">=</span> <span class="fl">13</span>,
  legendSize <span class="op">=</span> <span class="fl">13</span>,
  legendTitleSize <span class="op">=</span> <span class="fl">13</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bcdsCxdsHybridResults</span></code></pre></div>
<p><img src="cnsl_qc_files/figure-html/plot_umap_hybrid-1.png" width="1056"></p>
</div>
</div>
<div id="ambient-rna-detection" class="section level4">
<h4 class="hasAnchor">
<a href="#ambient-rna-detection" class="anchor"></a>Ambient RNA detection</h4>
<div id="decontx" class="section level5">
<h5 class="hasAnchor">
<a href="#decontx" class="anchor"></a>DecontX</h5>
<p>In droplet-based single cell technologies, ambient RNA that may have been released from apoptotic or damaged cells may get incorporated into another droplet, and can lead to contamination. <a href="https://rdrr.io/bioc/celda/man/decontX.html">decontX</a>, available from the <a href="https://bioconductor.org/packages/release/bioc/html/celda.html">celda</a>, is a Bayesian method for the identification of the contamination level at a cellular level.</p>
<p>The wrapper function plotDecontXResults can be used to plot the QC outputs from the DecontX algorithm.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">decontxResults</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotDecontXResults.html">plotDecontXResults</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>, sample <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span>, 
  reducedDimName <span class="op">=</span> <span class="st">"UMAP"</span>, combinePlot <span class="op">=</span> <span class="st">"all"</span>,
  titleSize <span class="op">=</span> <span class="fl">13</span>,
  axisLabelSize <span class="op">=</span> <span class="fl">13</span>,
  axisSize <span class="op">=</span> <span class="fl">13</span>,
  legendSize <span class="op">=</span> <span class="fl">13</span>,
  legendTitleSize <span class="op">=</span> <span class="fl">13</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">decontxResults</span></code></pre></div>
<p><img src="cnsl_qc_files/figure-html/plots_umap_decontx-1.png" width="864"></p>
</div>
</div>
</div>
<div id="filtering-the-dataset-1" class="section level3">
<h3 class="hasAnchor">
<a href="#filtering-the-dataset-1" class="anchor"></a>Filtering the dataset</h3>
<p>SingleCellExperiment objects can be subset by its colData using <code>subsetSCECols</code>. The usage of each argument is described in the <strong>Quality Control of Droplet Counts Data</strong> section above.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Before filtering:</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 32738  8119</code></pre>
<p>Remove barcodes with high mitochondrial gene expression:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc.combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subsetSCECols.html">subsetSCECols</a></span><span class="op">(</span><span class="va">pbmc.combined</span>, colData <span class="op">=</span> <span class="st">'subsets_mito_percent &lt; 20'</span><span class="op">)</span></code></pre></div>
<p>Remove detected doublets from Scrublet:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc.combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subsetSCECols.html">subsetSCECols</a></span><span class="op">(</span><span class="va">pbmc.combined</span>, colData <span class="op">=</span> <span class="st">'scrublet_call == FALSE'</span><span class="op">)</span></code></pre></div>
<p>Remove cells with high levels of ambient RNA contamination:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc.combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subsetSCECols.html">subsetSCECols</a></span><span class="op">(</span><span class="va">pbmc.combined</span>, colData <span class="op">=</span> <span class="st">'decontX_contamination &lt; 0.5'</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#After filtering:</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 32738  7937</code></pre>
</div>
<div id="running-individual-qc-methods-1" class="section level3">
<h3 class="hasAnchor">
<a href="#running-individual-qc-methods-1" class="anchor"></a>Running individual QC methods</h3>
<p>Instead of running all quality control methods on the dataset at once, users may elect to execute QC methods individually. The parameters as well as the outputs to individual QC functions are described in detail as follows:</p>
<div id="runpercellqc-1" class="section level4">
<h4 class="hasAnchor">
<a href="#runpercellqc-1" class="anchor"></a>runPerCellQC</h4>
<p>The wrapper function <code>runPerCellQC</code> can be used to separately compute QC metrics on its own.</p>
<p>In this function, the <code>inSCE</code> parameter is the input SingleCellExperiment object, while the <code>useAssay</code> parameter is the assay object that in the SingleCellExperiment object the user wishes to use.</p>
<p>If the user wishes, a list of gene sets can be applied to the function to determine the expression of a set of specific genes. A gene list imported into the SingleCellExperiment object using <code>importGeneSets</code> functions can be set as <code>collectionName</code>. Additionally, a pre-made list of genes can be used to determine the level of gene expression per cell. A list containing gene symbols may be set as <code>geneSetList</code>, or the user may instead use the <code>geneSetCollection</code> parameter to supply a <code>GeneSetCollection</code> object from the <a href="https://bioconductor.org/packages/release/bioc/html/GSEABase.html">GSEABase</a> package.</p>
<p>The QC outputs are <code>sum</code>, <code>detected</code>, and <code>percent_top_X</code>.</p>
<p><code>sum</code> contains the total number of counts for each cell.</p>
<p><code>detected</code> contains the total number of features for each cell.</p>
<p><code>percent_top_X</code> contains the percentage of the total counts that is made up by the expression of the top X genes for each cell.</p>
<p>The <code>subsets_</code> columns contain information for the specific gene list that was used. For instance, if a gene list containing mitochondrial genes named <code>mito</code> was used, <code>subsets_mito_sum</code> would contains the total number of mitochondrial counts for each cell.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc.combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPerCellQC.html">runPerCellQC</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>,
  useAssay <span class="op">=</span> <span class="st">"counts"</span>,
  collectionName <span class="op">=</span> <span class="st">"mito"</span><span class="op">)</span></code></pre></div>
</div>
<div id="runscrublet" class="section level4">
<h4 class="hasAnchor">
<a href="#runscrublet" class="anchor"></a>runScrublet</h4>
<p>The wrapper function <code>runScrublet</code> can be used to separately run the Scrublet algorithm on its own.</p>
<p>The <code>sample</code> parameter indicates what sample each cell originated from. It can be set to <code>NULL</code> if all cells in the dataset came from the same sample.</p>
<p>Scrublet also has a large set of parameters that the user can adjust; please refer to the Scrublet website for more details.</p>
<p>The Scrublet outputs are <code>scrublet_score</code>, which is a numeric variable of the likelihood that a cell is a doublet, and the <code>scrublet_label</code>, which is the assignment of whether the cell is a doublet.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc.combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runScrublet.html">runScrublet</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>,
  sample <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span>, 
  useAssay <span class="op">=</span> <span class="st">"counts"</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="runscdblfinder" class="section level4">
<h4 class="hasAnchor">
<a href="#runscdblfinder" class="anchor"></a>runScDblFinder</h4>
<p>The wrapper function <code>runBarcodeRankDrops</code> can be used to separately run the ScDblFinder algorithm on its own. The <code>nNeighbors</code> parameter is the number of nearest neighbor used to calculate the density for doublet detection. <code>simDoublets</code> is used to determine the number of simulated doublets used for doublet detection.</p>
<p>The output of ScDblFinder is a <code>scDblFinder_doublet_score</code>. The doublet score of a droplet will be higher if the it is deemed likely to be a doublet.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc.combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runScDblFinder.html">runScDblFinder</a></span><span class="op">(</span>inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>, sample <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span>, useAssay <span class="op">=</span> <span class="st">"counts"</span><span class="op">)</span></code></pre></div>
</div>
<div id="rundoubletfinder" class="section level4">
<h4 class="hasAnchor">
<a href="#rundoubletfinder" class="anchor"></a>runDoubletFinder</h4>
<p>The wrapper function <code>runDoubletFinder</code> can be used to separately run the DoubletFinder algorithm on its own. <code>runDoubletFinder</code> relies on a parameter (in Seurat) called resolution to determine cells that may be doublets. Users will be able to manipulate the resolution parameter through <code>seuratRes</code>. If multiple numeric vectors are stored in <code>seuratRes</code>, there will be multiple label/scores. The <code>seuratNfeatures</code> parameter determines the number of features that is used in the <code>FindVariableFeatures</code> function in Seurat. <code>seuratPcs</code> parameter determines the number of dimensions used in the <code>FindNeighbors</code> function in Seurat. The <code>formationRate</code> parameter is the estimated doublet detection rate in the dataset. aims to detect doublets by creating simulated doublets from combining transcriptomic profiles of existing cells in the dataset.</p>
<p>The DoubletFinder outputs are <code>doubletFinder_doublet_score</code>, which is a numeric variable of the likelihood that a cell is a doublet, and the <code>doubletFinder_doublet_label</code>, which is the assignment of whether the cell is a doublet.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc.combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runDoubletFinder.html">runDoubletFinder</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>, useAssay <span class="op">=</span> <span class="st">"counts"</span>,
  sample <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span>, 
  seuratRes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span>, seuratPcs <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,
  seuratNfeatures <span class="op">=</span> <span class="fl">2000</span>,
  formationRate <span class="op">=</span> <span class="fl">0.075</span>, seed <span class="op">=</span> <span class="fl">12345</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="runcxds" class="section level4">
<h4 class="hasAnchor">
<a href="#runcxds" class="anchor"></a>runCXDS</h4>
<p>The wrapper function <code>runCxds</code> can be used to separately run the CXDS algorithm on its own. In <code>runCxds</code>, the <code>ntop</code> parameter is the number of top variance genes to consider. The <code>binThresh</code> parameter is the minimum counts a gene needs to have to be included in the analysis. <code>verb</code> determines whether progress messages will be displayed or not. <code>retRes</code> will determine whether the gene pair results should be returned or not. The user may set the estimated number of doublets with estNdbl.</p>
<p>The output of <code>runCxds</code> is the doublet score, <code>scds_cxds_score</code>.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc.combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCxds.html">runCxds</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>, sample <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span>, 
  ntop <span class="op">=</span> <span class="fl">500</span>, binThresh <span class="op">=</span> <span class="fl">0</span>,
  verb <span class="op">=</span> <span class="cn">FALSE</span>, retRes <span class="op">=</span> <span class="cn">FALSE</span>, estNdbl <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="runbcds" class="section level4">
<h4 class="hasAnchor">
<a href="#runbcds" class="anchor"></a>runBCDS</h4>
<p>The wrapper function <code>runBcds</code> can be used to separately run the BCDS algorithm on its own. In <code>runBcds</code>, the <code>ntop</code> parameter is the number of top variance genes to consider. The <code>srat</code> parameter is the ratio between original number of cells and simulated doublets. The <code>nmax</code> parameter is the maximum number of cycles that the algorithm should run through. If set to <code>tune</code>, this will be automatic. The <code>varImp</code> parameter determines if the variable importance should be returned or not.</p>
<p>The output of <code>runBcds</code> is scds_bcds_score, which is the likelihood that a cell is a doublet.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc.combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runBcds.html">runBcds</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>, seed <span class="op">=</span> <span class="fl">12345</span>, sample <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span>, 
  ntop <span class="op">=</span> <span class="fl">500</span>, srat <span class="op">=</span> <span class="fl">1</span>, nmax <span class="op">=</span> <span class="st">"tune"</span>, varImp <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="runcxdsbcdshybrid" class="section level4">
<h4 class="hasAnchor">
<a href="#runcxdsbcdshybrid" class="anchor"></a>runCxdsBcdsHybrid</h4>
<p>The wrapper function <code>runCxdsBcdsHybrid</code> can be used to separately run the CXDS-BCDS hybrid algorithm on its own.</p>
<p>All parameters from the <code>runBCDS</code> and <code>runBCDS</code> functions may be applied to this function in the cxdsArgs and bcdsArgs parameters, respectively. The output of <code>runCxdsBcdsHybrid</code> is the doublet score, <code>scds_hybrid_score</code>.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc.combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runCxdsBcdsHybrid.html">runCxdsBcdsHybrid</a></span><span class="op">(</span>
  inSCE <span class="op">=</span> <span class="va">pbmc.combined</span>, sample <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span>, 
  seed <span class="op">=</span> <span class="fl">12345</span>, nTop <span class="op">=</span> <span class="fl">500</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="rundecontx" class="section level4">
<h4 class="hasAnchor">
<a href="#rundecontx" class="anchor"></a>runDecontX</h4>
<p>The outputs of <code>runDecontX</code> are <code>decontX_contamination</code> and <code>decontX_clusters</code>.</p>
<p>The wrapper function <code>runDecontX</code> can be used to separately run the DecontX algorithm on its own. <code>decontX_contamination</code> is a numeric vector which characterizes the level of contamination in each cell. Clustering is performed as part of the <code>runDecontX</code> algorithm. <code>decontX_clusters</code> is the resulting cluster assignment, which can also be labeled on the plot.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbmc.combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runDecontX.html">runDecontX</a></span><span class="op">(</span><span class="va">pbmc.combined</span>, sample <span class="op">=</span> <span class="fu">colData</span><span class="op">(</span><span class="va">pbmc.combined</span><span class="op">)</span><span class="op">$</span><span class="va">sample</span>, useAssay <span class="op">=</span> <span class="st">"counts"</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
<div id="session-information" class="section level1">
<h1 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session Information</h1>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.0.4 (2021-02-15)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 19042)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=Chinese (Simplified)_China.936 
## [2] LC_CTYPE=Chinese (Simplified)_China.936   
## [3] LC_MONETARY=Chinese (Simplified)_China.936
## [4] LC_NUMERIC=C                              
## [5] LC_TIME=Chinese (Simplified)_China.936    
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] TENxPBMCData_1.8.0          HDF5Array_1.18.1           
##  [3] rhdf5_2.34.0                BiocFileCache_1.14.0       
##  [5] dbplyr_2.1.0                dplyr_1.0.5                
##  [7] singleCellTK_2.0.0          DelayedArray_0.16.2        
##  [9] Matrix_1.3-2                SingleCellExperiment_1.12.0
## [11] SummarizedExperiment_1.20.0 Biobase_2.50.0             
## [13] GenomicRanges_1.42.0        GenomeInfoDb_1.26.2        
## [15] IRanges_2.24.1              S4Vectors_0.28.1           
## [17] BiocGenerics_0.36.0         MatrixGenerics_1.2.1       
## [19] matrixStats_0.58.0         
## 
## loaded via a namespace (and not attached):
##   [1] MCMCprecision_0.4.0           rappdirs_0.3.3               
##   [3] scds_1.6.0                    scattermore_0.7              
##   [5] R.methodsS3_1.8.1             SeuratObject_4.0.0           
##   [7] ragg_1.1.1                    tidyr_1.1.3                  
##   [9] ggplot2_3.3.3                 bit64_4.0.5                  
##  [11] knitr_1.31                    irlba_2.3.3                  
##  [13] R.utils_2.10.1                data.table_1.14.0            
##  [15] rpart_4.1-15                  doParallel_1.0.16            
##  [17] RCurl_1.98-1.2                generics_0.1.0               
##  [19] cowplot_1.1.1                 RSQLite_2.2.3                
##  [21] combinat_0.0-8                RANN_2.6.1                   
##  [23] future_1.21.0                 bit_4.0.4                    
##  [25] spatstat.data_2.0-0           webshot_0.5.2                
##  [27] xml2_1.3.2                    httpuv_1.5.5                 
##  [29] assertthat_0.2.1              viridis_0.5.1                
##  [31] xfun_0.21                     jquerylib_0.1.3              
##  [33] evaluate_0.14                 promises_1.2.0.1             
##  [35] fansi_0.4.2                   assertive.files_0.0-2        
##  [37] igraph_1.2.6                  DBI_1.1.1                    
##  [39] htmlwidgets_1.5.3             purrr_0.3.4                  
##  [41] ellipsis_0.3.1                RSpectra_0.16-0              
##  [43] annotate_1.68.0               deldir_0.2-10                
##  [45] sparseMatrixStats_1.2.1       vctrs_0.3.6                  
##  [47] ROCR_1.0-11                   abind_1.4-5                  
##  [49] RcppEigen_0.3.3.9.1           cachem_1.0.4                 
##  [51] withr_2.4.1                   GSVAdata_1.26.0              
##  [53] sctransform_0.3.2             scran_1.18.5                 
##  [55] goftest_1.2-2                 svglite_2.0.0                
##  [57] cluster_2.1.0                 ExperimentHub_1.16.0         
##  [59] dotCall64_1.0-1               lazyeval_0.2.2               
##  [61] crayon_1.4.1                  edgeR_3.32.1                 
##  [63] pkgconfig_2.0.3               labeling_0.4.2               
##  [65] nlme_3.1-152                  vipor_0.4.5                  
##  [67] rlang_0.4.10                  globals_0.14.0               
##  [69] lifecycle_1.0.0               miniUI_0.1.1.1               
##  [71] dbscan_1.1-6                  enrichR_3.0                  
##  [73] rsvd_1.0.3                    AnnotationHub_2.22.0         
##  [75] rprojroot_2.0.2               polyclip_1.10-0              
##  [77] lmtest_0.9-38                 graph_1.68.0                 
##  [79] Rhdf5lib_1.12.1               zoo_1.8-8                    
##  [81] beeswarm_0.3.1                ggridges_0.5.3               
##  [83] rjson_0.2.20                  png_0.1-7                    
##  [85] viridisLite_0.3.0             bitops_1.0-6                 
##  [87] R.oo_1.24.0                   KernSmooth_2.23-18           
##  [89] spam_2.6-0                    rhdf5filters_1.2.0           
##  [91] pROC_1.17.0.1                 blob_1.2.1                   
##  [93] DelayedMatrixStats_1.12.3     stringr_1.4.0                
##  [95] parallelly_1.23.0             gridGraphics_0.5-1           
##  [97] beachmat_2.6.4                scales_1.1.1                 
##  [99] memoise_2.0.0                 GSEABase_1.52.1              
## [101] magrittr_2.0.1                plyr_1.8.6                   
## [103] ica_1.0-2                     zlibbioc_1.36.0              
## [105] compiler_4.0.4                dqrng_0.2.1                  
## [107] kableExtra_1.3.4              RColorBrewer_1.1-2           
## [109] fitdistrplus_1.1-3            XVector_0.30.0               
## [111] listenv_0.8.0                 patchwork_1.1.1              
## [113] pbapply_1.4-3                 MASS_7.3-53                  
## [115] mgcv_1.8-33                   tidyselect_1.1.0             
## [117] MAST_1.16.0                   stringi_1.5.3                
## [119] textshaping_0.3.1             highr_0.8                    
## [121] yaml_2.2.1                    assertive.numbers_0.0-2      
## [123] BiocSingular_1.6.0            locfit_1.5-9.4               
## [125] ggrepel_0.9.1                 grid_4.0.4                   
## [127] sass_0.3.1                    tools_4.0.4                  
## [129] future.apply_1.7.0            rstudioapi_0.13              
## [131] foreach_1.5.1                 bluster_1.0.0                
## [133] celda_1.6.1                   gridExtra_2.3                
## [135] assertive.types_0.0-3         farver_2.1.0                 
## [137] Rtsne_0.15                    DropletUtils_1.10.3          
## [139] digest_0.6.27                 BiocManager_1.30.10          
## [141] FNN_1.1.3                     shiny_1.6.0                  
## [143] Rcpp_1.0.6                    scuttle_1.0.4                
## [145] BiocVersion_3.12.0            later_1.1.0.1                
## [147] RcppAnnoy_0.0.18              httr_1.4.2                   
## [149] AnnotationDbi_1.52.0          assertive.properties_0.0-4   
## [151] colorspace_2.0-0              rvest_0.3.6                  
## [153] XML_3.99-0.5                  fs_1.5.0                     
## [155] tensor_1.5                    reticulate_1.18              
## [157] splines_4.0.4                 fields_11.6                  
## [159] uwot_0.1.10                   statmod_1.4.35               
## [161] spatstat.utils_2.1-0          pkgdown_1.6.1                
## [163] scater_1.18.6                 xgboost_1.3.2.1              
## [165] plotly_4.9.3                  systemfonts_1.0.1            
## [167] xtable_1.8-4                  assertive.base_0.0-9         
## [169] jsonlite_1.7.2                spatstat_1.64-1              
## [171] R6_2.5.0                      pillar_1.5.1                 
## [173] htmltools_0.5.1.1             mime_0.10                    
## [175] glue_1.4.2                    fastmap_1.1.0                
## [177] BiocParallel_1.24.1           BiocNeighbors_1.8.2          
## [179] interactiveDisplayBase_1.28.0 codetools_0.2-18             
## [181] maps_3.3.0                    utf8_1.1.4                   
## [183] lattice_0.20-41               bslib_0.2.4                  
## [185] tibble_3.1.0                  multipanelfigure_2.1.2       
## [187] curl_4.3                      ggbeeswarm_0.6.0             
## [189] leiden_0.3.7                  scDblFinder_1.4.0            
## [191] magick_2.6.0                  survival_3.2-7               
## [193] limma_3.46.0                  rmarkdown_2.7                
## [195] desc_1.3.0                    munsell_0.5.0                
## [197] GenomeInfoDbData_1.2.4        iterators_1.0.13             
## [199] reshape2_1.4.4                gtable_0.3.0                 
## [201] Seurat_4.0.0</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by David Jenkins, Vidya Akavoor, Salam Alabdullatif, Shruthi Bandyadka, Emma Briars, Xinyun Cao, Sebastian Carrasco Pro, Tyler Faits, Rui Hong, Mohammed Muzamil Khan, Yusuke Koga, Anastasia Leshchyk, Irzam Sarfraz, Yichen Wang, Zhe Wang, W. Evan Johnson, Joshua David Campbell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
