<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Seurat Curated Workflow • singleCellTK</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Seurat Curated Workflow">
<meta property="og:description" content="singleCellTK">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">singleCellTK</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/introduction_to_SCTK.html">General Workflow</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Shell Command Line Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cmd_import_scRNAseq_data_as_SCE.html">Import data into SCTK</a>
    </li>
    <li>
      <a href="../articles/cmd_qc.html">Quality Control</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R Console Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cnsl_import_scRNAseq_data_as_SCE.html">Import data into SCTK</a>
    </li>
    <li>
      <a href="../articles/cnsl_qc.html">Quality Control</a>
    </li>
    <li>
      <a href="../articles/cnsl_normalization.html">Normalization</a>
    </li>
    <li>
      <a href="../articles/cnsl_batch_correction.html">Batch Correction</a>
    </li>
    <li>
      <a href="../articles/cnsl_feature_selection.html">Feature Selection</a>
    </li>
    <li>
      <a href="../articles/cnsl_clustering.html">Clustering</a>
    </li>
    <li>
      <a href="../articles/cnsl_differential_expression.html">Differential Expression</a>
    </li>
    <li>
      <a href="../articles/cnsl_find_marker.html">Find Marker via DE</a>
    </li>
    <li>
      <a href="../articles/cnsl_visualization.html">Visualization</a>
    </li>
    <li>
      <a href="../articles/cnsl_heatmap.html">Heatmap Visualization</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Shiny UI Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Import</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/ui_import_data.html">Data</a>
        </li>
        <li>
          <a href="../articles/ui_import_genesets.html">Gene Sets</a>
        </li>
        <li>
          <a href="../articles/ui_import_cell_annotation.html">Cell Annotation</a>
        </li>
        <li>
          <a href="../articles/ui_import_feature_annotation.html">Feature Annotation</a>
        </li>
        <li>
          <a href="../articles/ui_export_data.html">Export Data</a>
        </li>
        <li>
          <a href="../articles/ui_delete_data.html">Delete Data</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">QC &amp; Filtering</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/ui_qc.html">Quality Control</a>
        </li>
        <li>
          <a href="../articles/ui_filtering.html">Filtering</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Normalization &amp; Batch Correction</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/ui_normalization.html">Normalization</a>
        </li>
        <li>
          <a href="../articles/ui_batch_correction.html">Batch Correction</a>
        </li>
      </ul>
</li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Feature Selection &amp; Dimensionality Reduction</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/ui_feature_selection.html">Feature Selection</a>
        </li>
        <li>
          <a href="../articles/ui_dimred.html">Dimensionality Reduction</a>
        </li>
      </ul>
</li>
    <li>
      <a href="../articles/ui_clustering.html">Clustering</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Differential Expression &amp; Cell Type Labeling</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/ui_differential_expression.html">Differential Expression</a>
        </li>
        <li>
          <a href="../articles/ui_find_marker.html">Find Marker</a>
        </li>
      </ul>
</li>
    <li>
      <a href="../articles/ui_heatmap.html">Generic Heatmap</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/compbiomed/singleCellTK">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ui_seurat_curated_workflow_files/header-attrs-2.5/header-attrs.js"></script><link href="ui_seurat_curated_workflow_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="ui_seurat_curated_workflow_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Seurat Curated Workflow</h1>
                        <h4 class="author">Irzam Sarfraz</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/compbiomed/singleCellTK/blob/master/vignettes/ui_seurat_curated_workflow.Rmd"><code>vignettes/ui_seurat_curated_workflow.Rmd</code></a></small>
      <div class="hidden name"><code>ui_seurat_curated_workflow.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p><a href="https://satijalab.org/seurat/">Seurat</a> is an R package (<a href="https://www.nature.com/articles/nbt.4096">Butler et al., Nature Biotechnology 2018</a> &amp; <a href="https://www.cell.com/cell/fulltext/S0092-8674(19)30559-8">Stuart<em>, Butler</em>, et al., Cell 2019</a>) that offers various functions to perform analysis of scRNA-Seq data on the R console. In the singleCellTK, we implement all the common steps of the proposed workflow in an interactive and easy to use graphical interface including interactive visualizations. The purpose of this curated workflow is to allow the users to follow a standardized step-by-step workflow for an effortless analysis of their data.</p>
<div id="general-workflow" class="section level3">
<h3 class="hasAnchor">
<a href="#general-workflow" class="anchor"></a>General Workflow</h3>
<p>A general workflow for the <em>Feature Selection</em> sub-tab is summarized in the figure below: <img src="ui_screenshots/seurat/seurat_workflow.png"></p>
<p>In this tutorial example, we illustrate all the steps of the curated workflow and focus on the options available to manipulate and customize the steps of the workflow as per user requirements. To initiate the <code>Seurat</code> workflow, click on the ‘Curated Workflows’ from the top menu and select <code>Seurat</code>.</p>
<p>NOTE: This tutorial assumes that the data has already been uploaded via the <a href="">upload tab</a> of the toolkit and <a href="">filtered</a> before using the workflow.</p>
</div>
</div>
<div id="normalize-data" class="section level2">
<h2 class="hasAnchor">
<a href="#normalize-data" class="anchor"></a>1. Normalize Data</h2>
<p>Assuming that the data has been uploaded via the Upload tab of the toolkit, the first step for the analysis of the data is the Normalization of data. For this purpose, any assay available in the uploaded data can be used against one of the three methods of normalization available through <code>Seurat</code> i.e. <code>LogNormalize</code>, <code>CLR</code> (Centered Log Ratio) or <code>RC</code> (Relative Counts).</p>
<p><img src="ui_screenshots/seurat/seurat_1_normalize_annotated.png"></p>
<ol style="list-style-type: decimal">
<li>Open up the ‘Normalize’ tab by clicking on it.</li>
<li>Select the <code>assay</code> to normalize from the dropdown menu.</li>
<li>Select the normalization method from the dropdown menu. Available methods are <code>LogNormalize</code>, <code>CLR</code> or <code>RC</code>.</li>
<li>Set the scaling factor which represents the numeric value by which the data values are multiplied before log transformation. Default is set to <code>10000</code>.</li>
<li>Press the ‘Normalize’ button to start the normalization process.</li>
</ol>
</div>
<div id="scale-data" class="section level2">
<h2 class="hasAnchor">
<a href="#scale-data" class="anchor"></a>2. Scale Data</h2>
<p>Once normalization is complete, data needs to be scaled and centered accordingly. <code>Seurat</code> uses <code>linear</code> (linear model), <code>poisson</code> (generalized linear model) or <code>negbinom</code> (generalized linear model) as a regression model.</p>
<p><img src="ui_screenshots/seurat/seurat_2_scale_annotated.png"></p>
<ol style="list-style-type: decimal">
<li>Open up the ‘Scale Data’ tab.</li>
<li>Select model for scaling from <code>linear</code>, <code>poisson</code> or <code>negbinom</code>.</li>
<li>Select if you only want to scale data or center it as well.</li>
<li>Input maximum scaled data value. This is the maximum value to which the data will be scaled to.</li>
<li>Press ‘Scale’ button to start processing.</li>
</ol>
</div>
<div id="highly-variable-genes" class="section level2">
<h2 class="hasAnchor">
<a href="#highly-variable-genes" class="anchor"></a>3. Highly Variable Genes</h2>
<p>Identification of the highly variable genes is core to the <code>Seurat</code> workflow and these highly variable genes are used throughout the remaining workflow. <code>Seurat</code> provides three methods for variable genes identification i.e. <code>vst</code> (uses local polynomial regression to fit a relationship between log of variance and log of mean), <code>mean.var.plot</code> (uses mean and dispersion to divide features into bins) and <code>dispersion</code> (uses highest dispersion values only).</p>
<p><img src="ui_screenshots/seurat/seurat_3_hvg_annotated.png"></p>
<ol style="list-style-type: decimal">
<li>Open up the ‘Highly Variable Genes’ tab.</li>
<li>Select method for computation of highly variable genes from <code>vst</code>, <code>mean.var.plot</code> and <code>dispersion</code>.</li>
<li>Input the number of genes that should be identified as variable. Default is <code>2000</code>.</li>
<li>Press ‘Find HVG’ button to compute the variable genes.</li>
<li>Once genes are computed, select number of the top most variable genes to display in (6).</li>
<li>Displays the top most highly variable genes as selected in (5).</li>
<li>Graph that plots each gene and its relationship based upon the selected model in (2), and identifies if a gene is highly variable or not.</li>
</ol>
</div>
<div id="dimensionality-reduction" class="section level2">
<h2 class="hasAnchor">
<a href="#dimensionality-reduction" class="anchor"></a>4. Dimensionality Reduction</h2>
<p><code>Seurat</code> workflow offers <code>PCA</code> or <code>ICA</code> for dimensionality reduction and the components from these methods can be used in the downstream analysis. Moreover, several plots are available for the user to inspect the output of the dimensionality reduction such as the standard ‘PCA Plot’, ‘Elbow Plot’, ‘Jackstraw Plot’ and ‘Heatmap Plot’.</p>
<p><img src="ui_screenshots/seurat/seurat_4_dimensionalityReduction_annotated_1.png"></p>
<p><img src="ui_screenshots/seurat/seurat_4_dimensionalityReduction_annotated_2.png"></p>
<ol style="list-style-type: decimal">
<li>Open up the ‘Dimensionality Reduction’ tab.</li>
<li>Select a sub-tab for either ‘PCA’ or ‘ICA’ computation. Separate tabs are available for both methods if the user wishes to compute and inspect both separately.</li>
<li>Input the number of components to compute. Default value is <code>50</code>.</li>
<li>Select the plots that should be computed with the overall processing. The standard ‘PCA Plot’ will be computed at all times, while the remaining can be turned off if not required.</li>
<li>Input the number of features against which a ‘Heatmap’ should be plotted. Only available when ‘Compute Heatmap’ is set to <code>TRUE</code>.</li>
<li>Press the ‘Run PCA’ button to start processing.</li>
<li>Select the number of computed components that should be used in the downstream analysis e.g. in ‘tSNE/UMAP’ computation or with ‘Clustering’. If ‘Elbow Plot’ is computed, a suggested value will be indicated that should be preferred for downstream analysis.</li>
<li>The plot area from where all computed plots can be viewed by the user.</li>
<li>Heatmap plot has various options available for the users to customize the plot. Since a plot is computed against each component, a user-defined number of components can be selected against. Moreover, for viewing quality, a number of columns can be selected in which the plots should be shown.</li>
</ol>
</div>
<div id="tsneumap" class="section level2">
<h2 class="hasAnchor">
<a href="#tsneumap" class="anchor"></a>5. tSNE/UMAP</h2>
<p>‘tSNE’ and ‘UMAP’ can be computed and plotted once components are available from ‘Dimensionality Reduction’ tab.</p>
<p><img src="ui_screenshots/seurat/seurat_5_tsneUmap.png"></p>
<ol style="list-style-type: decimal">
<li>Open up the ‘tSNE/UMAP’ tab.</li>
<li>Select ‘tSNE’ or ‘UMAP’ sub-tab.</li>
<li>Select a reduction method. Only methods that are computed previously in the ‘Dimensionality Reduction’ tab are available.</li>
<li>Set perplexity tuning parameter.</li>
<li>Information displayed to the user that how many components from the selected reduction method will be used. This value can only be changed from the ‘Dimensionality Reduction’ tab.</li>
<li>Press ‘Run tSNE’ or ‘Run UMAP’ button to start processing.</li>
<li>‘tSNE’ or ‘UMAP’ plot depending upon the selected computation.</li>
</ol>
</div>
<div id="clustering" class="section level2">
<h2 class="hasAnchor">
<a href="#clustering" class="anchor"></a>6. Clustering</h2>
<p>Cluster labels can be generated for all cells/samples using one of the computed reduction method. Plots are automatically re-computed with cluster labels. The available algorithms for clustering as provided by <code>Seurat</code> include <code>original Louvain algorithm</code>, <code>Louvain algorithm with multilevel refinement</code> and <code>SLM algorithm</code>.</p>
<p><img src="ui_screenshots/seurat/seurat_6_clustering.png"></p>
<ol style="list-style-type: decimal">
<li>Open up the ‘Clustering’ tab.</li>
<li>Select a previously computed reduction method.</li>
<li>Select clustering algorithm from <code>original Louvain algorithm</code>, <code>Louvain algorithm with multilevel refinement</code> and <code>SLM algorithm</code>
</li>
<li>Set resolution parameter value for the algorithm. Default is <code>0.8</code>.</li>
<li>Set if singletons should be grouped to nearest clusters or not. Default is <code>TRUE</code>.</li>
<li>Information displayed to the user that how many components from the selected reduction method will be used. This value can only be changed from the ‘Dimensionality Reduction’ tab.</li>
<li>Press ‘Find Clusters’ button to start processing.</li>
<li>Re-computed plots with cluster labels. Only those plots are available that have previously been computed.</li>
</ol>
</div>
<div id="find-markers" class="section level2">
<h2 class="hasAnchor">
<a href="#find-markers" class="anchor"></a>7. Find Markers</h2>
<p>‘Find Markers’ tab can be used to identify and visualize the marker genes using on of the provided visualization methods. The tab offers identification of markers between two selected phenotype groups or between all groups and can be decided at the time of the computation. Furthermore, markers that are conserved between two phenotype groups can also be identified. Visualizations such as Ridge Plot, Violin Plot, Feature Plot and Heatmap Plot can be used to visualize the individual marker genes.</p>
<p><img src="ui_screenshots/seurat/seurat_7_findmarkers_1.png"> 1. Select if you want to identify marker genes against all groups in a biological variable or between two pre-defined groups. Additionally, users can select the last option to identify the marker genes that are conserved between two groups. 2. Select phenotype variable that contains the grouping information. 3. Select test used for marker genes identification. 4. Select if only positive markers should be returned. 5. Press “Find Markers” button to run marker identification.</p>
<p><img src="ui_screenshots/seurat/seurat_7_findmarkers_2.png"> 6. Identified marker genes are populated in the table. 7. Filters can be applied on the table.</p>
<p><img src="ui_screenshots/seurat/seurat_7_findmarkers_3.png"> 8. Filters allow different comparisons based on the type of the column of the table.</p>
<p><img src="ui_screenshots/seurat/seurat_7_findmarkers_4.png"> 9. Table re-populated after applying filters. 10. Heatmap plot can be visualized for all genes populated in the table (9) against all biological groups in the selected phenotype variable.</p>
<p><img src="ui_screenshots/seurat/seurat_7_findmarkers_5.png"> 11. To visualize each individual marker gene through gene plots, they can be selected by clicking on the relevant rows of the table.</p>
<p><img src="ui_screenshots/seurat/seurat_7_findmarkers_6.png"> 12. Selected marker genes from the table are plotted with gene plots.</p>
</div>
<div id="downstream-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#downstream-analysis" class="anchor"></a>8. Downstream Analysis</h2>
<p>Once all steps of the Seurat workflow are completed, users can further analyze the data by directly going to the various downstream analysis options (Differential Expression, Marker Selection &amp; Pathway Analysis) from within the Seurat workflow.</p>
<p><img src="ui_screenshots/seurat/seurat_7_findmarkers_7.png"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by David Jenkins, Vidya Akavoor, Salam Alabdullatif, Shruthi Bandyadka, Emma Briars, Xinyun Cao, Sebastian Carrasco Pro, Tyler Faits, Rui Hong, Mohammed Muzamil Khan, Yusuke Koga, Anastasia Leshchyk, Irzam Sarfraz, Yichen Wang, Zhe Wang, W. Evan Johnson, Joshua David Campbell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
