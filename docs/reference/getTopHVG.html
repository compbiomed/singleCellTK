<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Get or set top HVG after calculation — getTopHVG • singleCellTK</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Get or set top HVG after calculation — getTopHVG"><meta property="og:description" content="Extracts or select the top variable genes from an input
SingleCellExperiment object. Note that the variability metrics
must be computed using the runFeatureSelection method before
extracting the feature names of the top variable features. getTopHVG
only returns a character vector of the HVG selection, while with
setTopHVG, a logical vector of the selection will be saved in the
rowData, and optionally, a subset object for the HVGs can be stored
in the altExps slot at the same time."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">singleCellTK</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.18.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="https://www.camplab.net/sctk" class="external-link">
    <span class="fas fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/01_import_and_qc_tutorial.html">Importing and QC - PBMC3K</a>
    </li>
    <li>
      <a href="../articles/02_a_la_carte_workflow.html">A La Carte Workflow - PBMC3K</a>
    </li>
    <li>
      <a href="../articles/seurat_curated_workflow.html">Seurat Curated Workflow - PBMC3K</a>
    </li>
    <li>
      <a href="../articles/celda_curated_workflow.html">Celda Curated Workflow - PBMC3K</a>
    </li>
    <li>
      <a href="../articles/scanpy_curated_workflow.html">Scanpy Curated Workflow - PBMC3K</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/cmd_qc.html">SCTK-QC</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Documentation

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Data</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/import_data.html">Import Data</a>
        </li>
        <li>
          <a href="../articles/import_genesets.html">Import Gene Sets</a>
        </li>
        <li>
          <a href="../articles/import_annotation.html">Annotation</a>
        </li>
        <li>
          <a href="../articles/export_data.html">Export Data</a>
        </li>
        <li>
          <a href="../articles/delete_data.html">Delete Data</a>
        </li>
      </ul></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">QC &amp; Filtering</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/cnsl_dropletqc.html">Droplet QC (R console)</a>
        </li>
        <li>
          <a href="../articles/cnsl_cellqc.html">Cell QC (R console)</a>
        </li>
        <li>
          <a href="../articles/ui_qc.html">Cell QC (Shiny UI)</a>
        </li>
        <li>
          <a href="../articles/filtering.html">Filtering</a>
        </li>
      </ul></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Normalization &amp; Batch Correction</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/normalization.html">Normalization</a>
        </li>
        <li>
          <a href="../articles/batch_correction.html">Batch Correction</a>
        </li>
      </ul></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Feature Selection &amp; Dimensionality Reduction</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/feature_selection.html">Feature Selection</a>
        </li>
        <li>
          <a href="../articles/dimensionality_reduction.html">Dimensionality Reduction</a>
        </li>
        <li>
          <a href="../articles/2d_embedding.html">2D Embedding</a>
        </li>
      </ul></li>
    <li>
      <a href="../articles/clustering.html">Clustering</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Differential Expression &amp; Cell Type Labeling</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/differential_expression.html">Differential Expression</a>
        </li>
        <li>
          <a href="../articles/find_marker.html">Find Marker</a>
        </li>
        <li>
          <a href="../articles/cell_type_labeling.html">Cell Type Labeling</a>
        </li>
      </ul></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Pathway &amp; Enrichment Analysis</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/enrichR.html">EnrichR</a>
        </li>
        <li>
          <a href="../articles/pathwayAnalysis.html">Pathway Analysis</a>
        </li>
      </ul></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Trajectory Analysis</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/trajectoryAnalysis.html">TSCAN</a>
        </li>
      </ul></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Curated Workflows</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/seurat_curated_workflow.html">Seurat</a>
        </li>
        <li>
          <a href="../articles/celda_curated_workflow.html">Celda</a>
        </li>
      </ul></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Visualization</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/visualization.html">General Visualization</a>
        </li>
        <li>
          <a href="../articles/heatmap.html">Generic Heatmap</a>
        </li>
      </ul></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Web Application</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/webApp.html">FAQs</a>
        </li>
      </ul></li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">NEWS</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/compbiomed/singleCellTK" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
<li>
  <a href="https://twitter.com/camplab1" class="external-link">
    <span class="fab fa-twitter fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get or set top HVG after calculation</h1>
    <small class="dont-index">Source: <a href="https://github.com/compbiomed/singleCellTK/blob/HEAD/R/getTopHVG.R" class="external-link"><code>R/getTopHVG.R</code></a></small>
    <div class="hidden name"><code>getTopHVG.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extracts or select the top variable genes from an input
SingleCellExperiment object. Note that the variability metrics
must be computed using the <code>runFeatureSelection</code> method before
extracting the feature names of the top variable features. <code>getTopHVG</code>
only returns a character vector of the HVG selection, while with
<code>setTopHVG</code>, a logical vector of the selection will be saved in the
<code>rowData</code>, and optionally, a subset object for the HVGs can be stored
in the <code>altExps</code> slot at the same time.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getTopHVG</span><span class="op">(</span></span>
<span>  <span class="va">inSCE</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vst"</span>, <span class="st">"dispersion"</span>, <span class="st">"mean.var.plot"</span>, <span class="st">"modelGeneVar"</span>, <span class="st">"seurat"</span>, <span class="st">"seurat_v3"</span>,</span>
<span>    <span class="st">"cell_ranger"</span><span class="op">)</span>,</span>
<span>  hvgNumber <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  useFeatureSubset <span class="op">=</span> <span class="st">"hvf"</span>,</span>
<span>  featureDisplay <span class="op">=</span> <span class="fu">metadata</span><span class="op">(</span><span class="va">inSCE</span><span class="op">)</span><span class="op">$</span><span class="va">featureDisplay</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">setTopHVG</span><span class="op">(</span></span>
<span>  <span class="va">inSCE</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vst"</span>, <span class="st">"dispersion"</span>, <span class="st">"mean.var.plot"</span>, <span class="st">"modelGeneVar"</span>, <span class="st">"seurat"</span>, <span class="st">"seurat_v3"</span>,</span>
<span>    <span class="st">"cell_ranger"</span><span class="op">)</span>,</span>
<span>  hvgNumber <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  featureSubsetName <span class="op">=</span> <span class="st">"hvg2000"</span>,</span>
<span>  genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  genesBy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  altExp <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-insce">inSCE<a class="anchor" aria-label="anchor" href="#arg-insce"></a></dt>
<dd><p>Input SingleCellExperiment object</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Specify which method to use for variable gene extraction
from Seurat <code>"vst"</code>, <code>"mean.var.plot"</code>, <code>"dispersion"</code> or
Scran <code>"modelGeneVar"</code> or Scanpy <code>"seurat"</code>, <code>"cell_ranger"</code>,
<code>"seurat_v3"</code>. Default <code>"vst"</code></p></dd>


<dt id="arg-hvgnumber">hvgNumber<a class="anchor" aria-label="anchor" href="#arg-hvgnumber"></a></dt>
<dd><p>Specify the number of top variable genes to extract.</p></dd>


<dt id="arg-usefeaturesubset">useFeatureSubset<a class="anchor" aria-label="anchor" href="#arg-usefeaturesubset"></a></dt>
<dd><p>Get the feature names in the HVG list set by
<code>setTopHVG</code>. <code>method</code> and <code>hvgNumber</code> will not be used if not
this is not <code>NULL</code>. Default <code>"hvf"</code>.</p></dd>


<dt id="arg-featuredisplay">featureDisplay<a class="anchor" aria-label="anchor" href="#arg-featuredisplay"></a></dt>
<dd><p>A character string for the <code>rowData</code> variable name
to indicate what type of feature ID should be displayed. If set by
<code><a href="setSCTKDisplayRow.html">setSCTKDisplayRow</a></code>, will by default use it. If <code>NULL</code>, will
use <code>rownames(inSCE)</code>.</p></dd>


<dt id="arg-featuresubsetname">featureSubsetName<a class="anchor" aria-label="anchor" href="#arg-featuresubsetname"></a></dt>
<dd><p>A character string for the <code>rowData</code> variable
name to store a logical index of selected features. Default <code>"hvg2000"</code>.</p></dd>


<dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>A customized character vector of gene list to be set as a
<code>rowData</code> variable. Will ignore <code>method</code> and <code>hvgNumber</code> if
set. Default <code>NULL</code>.</p></dd>


<dt id="arg-genesby">genesBy<a class="anchor" aria-label="anchor" href="#arg-genesby"></a></dt>
<dd><p>If setting customized <code>genes</code>, where should it be found
in <code>rowData</code>? Leave <code>NULL</code> for matching <code>rownames</code>. Default
<code>NULL</code>.</p></dd>


<dt id="arg-altexp">altExp<a class="anchor" aria-label="anchor" href="#arg-altexp"></a></dt>
<dd><p><code>TRUE</code> for also creating a subset <code>inSCE</code> object with
the selected HVGs and store this subset in the <code>altExps</code> slot, named by
<code>hvgListName</code>. Default <code>FALSE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>


<dl><dt>getTopHVG</dt>
<dd><p>A character vector of the top <code>hvgNumber</code> variable
feature names</p></dd>

<dt>setTopHVG</dt>
<dd><p>The input <code>inSCE</code> object with the logical vector of
HVG selection updated in <code>rowData</code>, and related parameter updated in
<code>metadata</code>. If <code>altExp</code> is <code>TRUE</code>, an <code>altExp</code> is also
added</p></dd>

</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="runFeatureSelection.html">runFeatureSelection</a></code>, <code><a href="runSeuratFindHVG.html">runSeuratFindHVG</a></code>,
<code><a href="runModelGeneVar.html">runModelGeneVar</a></code>, <code><a href="plotTopHVG.html">plotTopHVG</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Irzam Sarfraz, Yichen Wang</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"scExample"</span>, package <span class="op">=</span> <span class="st">"singleCellTK"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a "highy variable feature" subset using Seurat's vst method:</span></span></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="runSeuratFindHVG.html">runSeuratFindHVG</a></span><span class="op">(</span><span class="va">sce</span>,  method <span class="op">=</span> <span class="st">"vst"</span>, hvgNumber <span class="op">=</span> <span class="fl">2000</span>,</span></span>
<span class="r-in"><span>       createFeatureSubset <span class="op">=</span> <span class="st">"hvf"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finding variable features for layer counts</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Wed Apr 23 11:37:36 2025 ... Feature subset variable 'hvf' created.</span>
<span class="r-in"><span>       </span></span>
<span class="r-in"><span><span class="co"># Get the list of genes for a feature subset:</span></span></span>
<span class="r-in"><span><span class="va">hvgs</span> <span class="op">&lt;-</span> <span class="fu">getTopHVG</span><span class="op">(</span><span class="va">sce</span>, useFeatureSubset <span class="op">=</span> <span class="st">"hvf"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a new feature subset on the fly without rerunning the algorithm:</span></span></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu">setTopHVG</span><span class="op">(</span><span class="va">sce</span>, method <span class="op">=</span> <span class="st">"vst"</span>, hvgNumber <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                featureSubsetName <span class="op">=</span> <span class="st">"hvf100"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Wed Apr 23 11:37:36 2025 ... Feature subset variable 'hvf100' created.</span>
<span class="r-in"><span><span class="va">hvgs</span> <span class="op">&lt;-</span> <span class="fu">getTopHVG</span><span class="op">(</span><span class="va">sce</span>, useFeatureSubset <span class="op">=</span> <span class="st">"hvf100"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get a list of variable features without creating a new feature subset:</span></span></span>
<span class="r-in"><span><span class="va">hvgs</span> <span class="op">&lt;-</span> <span class="fu">getTopHVG</span><span class="op">(</span><span class="va">sce</span>, useFeatureSubset <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                  method <span class="op">=</span> <span class="st">"vst"</span>, hvgNumber <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yichen Wang, Irzam Sarfraz, Rui Hong, Yusuke Koga, Salam Alabdullatif, Nida Pervaiz, David Jenkins, Vidya Akavoor, Xinyun Cao, Shruthi Bandyadka, Anastasia Leshchyk, Tyler Faits, Mohammed Muzamil Khan, Zhe Wang, W. Evan Johnson, Ming Liu, Joshua David Campbell.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

