<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Find doublets using scrublet. — runScrublet • singleCellTK</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Find doublets using scrublet. — runScrublet"><meta property="og:description" content="A wrapper function that calls scrub_doublets from python
 module scrublet. Simulates doublets from the observed data and uses
 a k-nearest-neighbor classifier to calculate a continuous
 scrublet_score (between 0 and 1) for each transcriptome. The score
 is automatically thresholded to generate scrublet_call, a boolean
 array that is TRUE for predicted doublets and FALSE
 otherwise."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">singleCellTK</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="https://www.camplab.net/sctk" class="external-link">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/console_analysis_tutorial.html">A La Carte Workflow - PBMC3K (R Console)</a>
    </li>
    <li>
      <a href="../articles/cnsl_seurat_curated_workflow.html">Seurat Curated Workflow - PBMC3K</a>
    </li>
    <li>
      <a href="../articles/celda_curated_workflow.html">Celda Curated Workflow - PBMC3K</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/cmd_qc.html">SCTK-QC</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Documentation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Data</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/import_data.html">Import Data</a>
        </li>
        <li>
          <a href="../articles/import_genesets.html">Import Gene Sets</a>
        </li>
        <li>
          <a href="../articles/import_annotation.html">Annotation</a>
        </li>
        <li>
          <a href="../articles/export_data.html">Export Data</a>
        </li>
        <li>
          <a href="../articles/delete_data.html">Delete Data</a>
        </li>
      </ul></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">QC &amp; Filtering</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/cnsl_dropletqc.html">Droplet QC (R console)</a>
        </li>
        <li>
          <a href="../articles/cnsl_cellqc.html">Cell QC (R console)</a>
        </li>
        <li>
          <a href="../articles/ui_qc.html">Cell QC (Shiny UI)</a>
        </li>
        <li>
          <a href="../articles/filtering.html">Filtering</a>
        </li>
      </ul></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Normalization &amp; Batch Correction</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/cnsl_normalization.html">Normalization</a>
        </li>
        <li>
          <a href="../articles/batch_correction.html">Batch Correction</a>
        </li>
      </ul></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Feature Selection &amp; Dimensionality Reduction</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/cnsl_feature_selection.html">Feature Selection</a>
        </li>
        <li>
          <a href="../articles/cnsl_dimensionality_reduction.html">Dimensionality Reduction</a>
        </li>
        <li>
          <a href="../articles/cnsl_2d_embedding.html">2D Embedding</a>
        </li>
      </ul></li>
    <li>
      <a href="../articles/clustering.html">Clustering</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Differential Expression &amp; Cell Type Labeling</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/differential_expression.html">Differential Expression</a>
        </li>
        <li>
          <a href="../articles/find_marker.html">Find Marker</a>
        </li>
        <li>
          <a href="../articles/cell_type_labeling.html">Cell Type Labeling</a>
        </li>
      </ul></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Enrichment &amp; Pathway Analysis</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/cnsl_enrichR.html">EnrichR</a>
        </li>
        <li>
          <a href="../articles/pathwayAnalysis.html">Pathway Analysis</a>
        </li>
      </ul></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Curated Workflows</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/cnsl_seurat_curated_workflow.html">Seurat</a>
        </li>
        <li>
          <a href="../articles/celda_curated_workflow.html">Celda</a>
        </li>
      </ul></li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Visualization</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/visualization.html">General Visualization</a>
        </li>
        <li>
          <a href="../articles/heatmap.html">Generic Heatmap</a>
        </li>
      </ul></li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">NEWS</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/compbiomed/singleCellTK" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/camplab1" class="external-link">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find doublets using <code>scrublet</code>.</h1>
    <small class="dont-index">Source: <a href="https://github.com/compbiomed/singleCellTK/blob/HEAD/R/scrublet_doubletDetection.R" class="external-link"><code>R/scrublet_doubletDetection.R</code></a></small>
    <div class="hidden name"><code>runScrublet.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A wrapper function that calls <code>scrub_doublets</code> from python
 module <code>scrublet</code>. Simulates doublets from the observed data and uses
 a k-nearest-neighbor classifier to calculate a continuous
 <code>scrublet_score</code> (between 0 and 1) for each transcriptome. The score
 is automatically thresholded to generate <code>scrublet_call</code>, a boolean
 array that is <code>TRUE</code> for predicted doublets and <code>FALSE</code>
 otherwise.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">runScrublet</span><span class="op">(</span>
  <span class="va">inSCE</span>,
  sample <span class="op">=</span> <span class="cn">NULL</span>,
  useAssay <span class="op">=</span> <span class="st">"counts"</span>,
  simDoubletRatio <span class="op">=</span> <span class="fl">2</span>,
  nNeighbors <span class="op">=</span> <span class="cn">NULL</span>,
  minDist <span class="op">=</span> <span class="cn">NULL</span>,
  expectedDoubletRate <span class="op">=</span> <span class="fl">0.1</span>,
  stdevDoubletRate <span class="op">=</span> <span class="fl">0.02</span>,
  syntheticDoubletUmiSubsampling <span class="op">=</span> <span class="fl">1</span>,
  useApproxNeighbors <span class="op">=</span> <span class="cn">TRUE</span>,
  distanceMetric <span class="op">=</span> <span class="st">"euclidean"</span>,
  getDoubletNeighborParents <span class="op">=</span> <span class="cn">FALSE</span>,
  minCounts <span class="op">=</span> <span class="fl">3</span>,
  minCells <span class="op">=</span> <span class="fl">3L</span>,
  minGeneVariabilityPctl <span class="op">=</span> <span class="fl">85</span>,
  logTransform <span class="op">=</span> <span class="cn">FALSE</span>,
  meanCenter <span class="op">=</span> <span class="cn">TRUE</span>,
  normalizeVariance <span class="op">=</span> <span class="cn">TRUE</span>,
  nPrinComps <span class="op">=</span> <span class="fl">30L</span>,
  tsneAngle <span class="op">=</span> <span class="cn">NULL</span>,
  tsnePerplexity <span class="op">=</span> <span class="cn">NULL</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>,
  seed <span class="op">=</span> <span class="fl">12345</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>inSCE</dt>
<dd><p>A <a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a> object.
Needs <code>counts</code> in assays slot.</p></dd>
<dt>sample</dt>
<dd><p>Character vector. Indicates which sample each cell belongs to.
Scrublet will be run on cells from each sample separately. If NULL, then
all cells will be processed together. Default <code>NULL</code>.</p></dd>
<dt>useAssay</dt>
<dd><p>A string specifying which assay in the SCE to use. Default
'counts'.</p></dd>
<dt>simDoubletRatio</dt>
<dd><p>Numeric. Number of doublets to simulate relative to
the number of observed transcriptomes. Default 2.0.</p></dd>
<dt>nNeighbors</dt>
<dd><p>Integer. Number of neighbors used to construct the KNN
graph of observed transcriptomes and simulated doublets. If <code>NULL</code>,
this is set to <code>round(0.5 * sqrt(n_cells))</code>. Default <code>NULL</code>.</p></dd>
<dt>minDist</dt>
<dd><p>Float Determines how tightly UMAP packs points together. If <code>NULL</code>,
this is set to 0.1. Default <code>NULL</code>.</p></dd>
<dt>expectedDoubletRate</dt>
<dd><p>The estimated doublet rate for the experiment.
Default 0.1.</p></dd>
<dt>stdevDoubletRate</dt>
<dd><p>Uncertainty in the expected doublet rate.
Default 0.02.</p></dd>
<dt>syntheticDoubletUmiSubsampling</dt>
<dd><p>Numeric. Rate for sampling UMIs
when creating synthetic doublets. If 1.0, each doublet is created by simply
adding the UMIs from two randomly sampled observed transcriptomes. For
values less than 1, the UMI counts are added and then randomly sampled at
the specified rate. Defuault: 1.0.</p></dd>
<dt>useApproxNeighbors</dt>
<dd><p>Boolean. Use approximate nearest neighbor method
(<code>annoy</code>) for the KNN classifier. Default <code>TRUE</code>.</p></dd>
<dt>distanceMetric</dt>
<dd><p>Character. Distance metric used when finding nearest
neighbors.
For list of valid values, see the documentation for <code>annoy</code> (if
<code>useApproxNeighbors</code> is <code>TRUE</code>) or
<code>sklearn.neighbors.NearestNeighbors</code> (if <code>useApproxNeighbors</code> is
<code>FALSE</code>). Default "euclidean".</p></dd>
<dt>getDoubletNeighborParents</dt>
<dd><p>Boolean. If <code>TRUE</code>, return the
parent transcriptomes that generated the doublet neighbors of each
observed transcriptome. This information can be used to infer the cell
states that generated a given doublet state. Default <code>FALSE</code>.</p></dd>
<dt>minCounts</dt>
<dd><p>Numeric. Used for gene filtering prior to PCA. Genes
expressed at fewer than <code>minCounts</code> in fewer than <code>minCells</code>
(see below) are excluded. Default 3.</p></dd>
<dt>minCells</dt>
<dd><p>Integer. Used for gene filtering prior to PCA. Genes
expressed at fewer than <code>minCounts</code> (see above) in fewer than
<code>minCells</code> are excluded. Default 3.</p></dd>
<dt>minGeneVariabilityPctl</dt>
<dd><p>Numeric. Used for gene filtering prior to
PCA. Keep the most highly variable genes (in the top
minGeneVariabilityPctl percentile), as measured by the v-statistic
(<em>Klein et al., Cell 2015</em>). Default 85.</p></dd>
<dt>logTransform</dt>
<dd><p>Boolean. If <code>TRUE</code>, log-transform the counts matrix
(log10(1+TPM)). <code>sklearn.decomposition.TruncatedSVD</code> will be used for
dimensionality reduction, unless <code>meanCenter</code> is <code>TRUE</code>.
Default <code>FALSE</code>.</p></dd>
<dt>meanCenter</dt>
<dd><p>If <code>TRUE</code>, center the data such that each gene has a
mean of 0. <code>sklearn.decomposition.PCA</code> will be used for
dimensionality reduction. Default <code>TRUE</code>.</p></dd>
<dt>normalizeVariance</dt>
<dd><p>Boolean. If <code>TRUE</code>, normalize the data such
that each gene has a variance of 1.
<code>sklearn.decomposition.TruncatedSVD</code> will be used for dimensionality
reduction, unless <code>meanCenter</code> is <code>TRUE</code>. Default <code>TRUE</code>.</p></dd>
<dt>nPrinComps</dt>
<dd><p>Integer. Number of principal components used to embed
the transcriptomes prior to k-nearest-neighbor graph construction.
Default 30.</p></dd>
<dt>tsneAngle</dt>
<dd><p>Float. Determines angular size of a distant node as measured
from a point in the t-SNE plot. If default, it is set to 0.5 Default <code>NULL</code>.</p></dd>
<dt>tsnePerplexity</dt>
<dd><p>Integer. The number of nearest neighbors that
is used in other manifold learning algorithms.
If default, it is set to 30. Default <code>NULL</code>.</p></dd>
<dt>verbose</dt>
<dd><p>Boolean. If <code>TRUE</code>, print progress updates. Default
<code>TRUE</code>.</p></dd>
<dt>seed</dt>
<dd><p>Seed for the random number generator. Default 12345.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a> object with
<code>scrub_doublets</code> output appended to the
colData slot. The columns include
<em>scrublet_score</em> and <em>scrublet_call</em>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">scExample</span>, package <span class="op">=</span> <span class="st">"singleCellTK"</span><span class="op">)</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="subsetSCECols.html">subsetSCECols</a></span><span class="op">(</span><span class="va">sce</span>, colData <span class="op">=</span> <span class="st">"type != 'EmptyDroplet'"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu">runScrublet</span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yichen Wang, Irzam Sarfraz, Rui Hong, Yusuke Koga, Salam Alabdullatif, David Jenkins, Vidya Akavoor, Xinyun Cao, Shruthi Bandyadka, Anastasia Leshchyk, Tyler Faits, Mohammed Muzamil Khan, Zhe Wang, W. Evan Johnson, Joshua David Campbell.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

